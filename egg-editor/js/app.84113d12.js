(function(t){function e(e){for(var r,i,s=e[0],c=e[1],u=e[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(p.length)p.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/egg-editor/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var r=n("85ec"),a=n.n(r);a.a},"098c":function(t,e,n){},1780:function(t,e,n){"use strict";var r=n("3a89"),a=n.n(r);a.a},"20de":function(t,e,n){},2274:function(t,e,n){t.exports=n.p+"img/lty.69b8954c.png"},2379:function(t,e,n){},"30cd":function(t,e,n){},"337a":function(t,e,n){"use strict";var r=n("4b80"),a=n.n(r);a.a},3530:function(t,e,n){t.exports=n.p+"img/mqx.ecd9168a.png"},"3a89":function(t,e,n){},"406b":function(t,e,n){"use strict";var r=n("ebbf"),a=n.n(r);a.a},4180:function(t,e,n){},4361:function(t,e,n){"use strict";var r=n("2379"),a=n.n(r);a.a},"452c":function(t,e,n){},"4b80":function(t,e,n){},"4d17":function(t,e,n){},"4fa5":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Layout",{attrs:{id:"app"}},[n("Header",{staticClass:"app-header"},[n("img",{staticClass:"logo",attrs:{src:"favicon.png",alt:"logo"}}),n("h1",{staticClass:"app-name"},[t._v(t._s(t.name))]),n("Button",{staticClass:"button",attrs:{icon:"ios-home-outline",shape:"circle"},on:{click:function(e){t.page="home"}}},[t._v("主页")]),n("Button",{staticClass:"button",attrs:{icon:"ios-menu-outline",shape:"circle"},on:{click:function(e){t.page="node-manager"}}},[t._v("节点管理器")]),n("Button",{staticClass:"button",attrs:{icon:"ios-albums-outline",shape:"circle"},on:{click:function(e){t.page="resource-manager"}}},[t._v("资源管理器")]),n("Button",{staticClass:"button",attrs:{icon:"ios-contact-outline",shape:"circle"},on:{click:function(e){t.page="role-manager"}}},[t._v("角色管理器")]),n("Button",{staticClass:"button",attrs:{icon:"ios-open-outline",shape:"circle"},on:{click:t.load}},[t._v("载入")]),n("Button",{staticClass:"button",attrs:{icon:"ios-exit-outline",shape:"circle"},on:{click:t.save}},[t._v("保存")]),n("Button",{staticClass:"button",attrs:{icon:"ios-link-outline",shape:"circle"},on:{click:t.exportData}},[t._v("导出")]),n("Button",{staticClass:"button",attrs:{icon:"ios-link-outline",shape:"circle"},on:{click:function(e){t.inputting=!0}}},[t._v("导入")]),n("Button",{staticClass:"button",attrs:{shape:"circle"},on:{click:t.test}},[t._v("测试")])],1),n("Content",{staticClass:"content"},["home"===t.page?n("Home"):"node-manager"===t.page?n("NodeManager"):"resource-manager"===t.page?n("ResourceManager"):"role-manager"===t.page?n("RoleManager"):t._e()],1),n("Modal",{staticClass:"modal",attrs:{title:"复制以下文本并保存到本地","ok-text":"复制","cancel-text":"关闭"},on:{"on-ok":t.copyData,"on-cancel":function(e){t.outputting=!1}},model:{value:t.outputting,callback:function(e){t.outputting=e},expression:"outputting"}},[n("p",{ref:"outputData",staticClass:"modal-content"},[t._v(" "+t._s(t.outputData)+" ")])]),n("Modal",{staticClass:"modal",attrs:{title:"在此处粘贴工程存档","ok-text":"导入","cancel-text":"取消"},on:{"on-ok":t.importData,"on-cancel":function(e){t.inputting=!1}},model:{value:t.inputting,callback:function(e){t.inputting=e},expression:"inputting"}},[n("Input",{ref:"saveText",staticClass:"modal-input",attrs:{type:"textarea",autosize:""},model:{value:t.inputData,callback:function(e){t.inputData=e},expression:"inputData"}})],1)],1)},o=[],i=(n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("fc11")),s=n("beb5"),c=n("9259"),u=n("e3f5"),l=n("af63"),d=n("df4a"),p=n("8679"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Layout",{staticClass:"node-manager"},[n("Sider",{staticClass:"sider",attrs:{width:250}},[n("NodeOverview",{attrs:{nodes:t.nodes}})],1),n("Layout",[n("Header",{staticClass:"header"},[n("p",{staticClass:"title"},[t._v("节点编辑器")]),n("Button",{staticClass:"button",attrs:{shape:"circle",icon:"ios-flag-outline"},on:{click:function(e){return t.addNode("label")}}},[t._v("标签")]),n("Button",{staticClass:"button",attrs:{shape:"circle",icon:"ios-git-commit"},on:{click:function(e){return t.addNode("line")}}},[t._v("台词")]),n("Button",{staticClass:"button",attrs:{shape:"circle",icon:"ios-git-branch"},on:{click:function(e){return t.addNode("option")}}},[t._v("选项")])],1),n("Content",{staticClass:"nodes"},[t.nodes.length?n("transition-group",{ref:"nodeList",staticClass:"node-list",attrs:{tag:"div","enter-active-class":"animated fadeInUp fast","leave-active-class":"animated fadeOutRight fast"}},t._l(t.nodes,(function(t,e){return n("Node",{key:t.uid,staticClass:"node-wrapper",attrs:{node:t,index:e}})})),1):n("p",{staticClass:"empty-node-list-hint"},[t._v("节点空空如也，点击右上方的按钮添加节点哦")])],1)],1)],1)},m=[],v=n("2a43"),b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node",on:{mouseenter:function(e){t.hover=!0},mouseleave:function(e){t.hover=!1}}},[n(t.component,{tag:"component",staticClass:"node-content",attrs:{node:t.node}}),n("div",{staticClass:"action-wrapper"},[n("transition",{attrs:{"enter-active-class":"animated fadeInRight faster","leave-active-class":"animated fadeOutRight faster"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.hover,expression:"hover"}],staticClass:"action"},[n("Button",{attrs:{type:"warning",icon:"ios-trash-outline",shape:"circle"},on:{click:t.deleteNode}}),n("div",{staticClass:"mover"},[n("Icon",{attrs:{type:"ios-arrow-up",size:20},on:{click:function(e){return t.move(-1)}}}),n("Icon",{attrs:{type:"ios-arrow-down",size:20},on:{click:function(e){return t.move(1)}}})],1)],1)])],1)],1)},h=[],g=(n("a9e3"),n("5250")),O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node"},[n("Dropdown",{staticClass:"role-select",attrs:{trigger:"click"},on:{"on-click":t.selectSpeaker}},[n("Avatar",{attrs:{src:t.speakerSrc,icon:"ios-contact"}}),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.roles,(function(e){return n("DropdownItem",{key:e.uid,attrs:{name:e.uid}},[t._v(t._s(e.name))])})),1)],1),n("div",{staticClass:"info"},[n("span",{staticClass:"speaker"},[t._v(t._s(t.speakerName))]),n("BetterInput",{staticClass:"content-edit",attrs:{"init-value":t.node.text},on:{confirm:t.handleConfirm}})],1)],1)},y=[],w=(n("7db0"),n("b0c0"),n("674c")),_=n("e79d"),j=n("90b2"),C=n("c5c1"),x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"better-input"},[t.editing?n("div",{staticClass:"panel"},[n("Input",{ref:"ipt",staticClass:"value",attrs:{size:t.size,type:"text",placeholder:"在此输入单行台词",clearable:""},on:{"on-enter":t.confirmInput,"on-blur":t.handleInputBlur},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t.buttons?n("Button",{staticClass:"button",attrs:{shape:"circle",type:"primary",icon:"ios-checkmark"},on:{click:t.confirmInput}}):t._e(),t.buttons?n("Button",{staticClass:"button",attrs:{shape:"circle",type:"warning",icon:"ios-close"},on:{click:t.cancelInput}}):t._e()],1):n("div",{staticClass:"panel"},[n("span",{staticClass:"value",on:{click:function(e){t.editing=!0}}},[t._v(t._s(t.value))])])])},k=[],D={name:"BetterInput",components:{Input:s["a"],Button:u["a"]},props:{size:{type:String,required:!1,default:function(){return"default"}},initValue:{type:String,required:!1,default:function(){return""}},buttons:{type:Boolean,required:!1,default:function(){return!0}}},data:function(){return{prev:this.initValue||"非空内容",value:this.initValue||"非空内容",editing:!1}},watch:{initValue:function(t){this.value=t||"非空内容",this.prev=t},editing:function(t){var e=this;t&&this.$nextTick((function(){return e.$refs.ipt.focus()}))}},methods:{confirmInput:function(){this.editing=!1,this.prev=this.value,this.$emit("confirm",this.value)},cancelInput:function(){this.editing=!1,this.value=this.prev,this.$emit("cancel",this.value)},handleInputBlur:function(){this.buttons||this.cancelInput()}}},S=D,P=(n("4361"),n("2877")),N=Object(P["a"])(S,x,k,!1,null,"36cf19cf",null),I=N.exports,R=n("2f62");function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var E={name:"LineNode",components:{BetterInput:I,Dropdown:C["a"],DropdownMenu:j["a"],DropdownItem:_["a"],Avatar:w["a"]},props:{node:{type:Object,required:!0}},data:function(){return{speakerSrc:"",speakerName:""}},computed:$({},Object(R["e"])(["roles","resources"])),watch:{speakerText:function(t){this.node.speaker=t}},methods:{refreshSpeaker:function(){var t=this,e=this.roles.find((function(e){return e.uid===t.node.role}));if(e)if(this.speakerName=e.name,e.avatar){var n=this.resources.find((function(t){return t.uid===e.avatar}));n&&(this.speakerSrc=n.src)}else this.speakerSrc=""},selectSpeaker:function(t){this.$store.commit("updateNode",{uid:this.node.uid,role:t,speaker:this.speakerText}),this.refreshSpeaker()},handleConfirm:function(t){this.$store.commit("updateNode",{uid:this.node.uid,text:t})}},mounted:function(){this.refreshSpeaker()}},L=E,T=(n("9a17"),Object(P["a"])(L,O,y,!1,null,"1725133f",null)),U=T.exports,M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"label"},[n("BetterInput",{staticClass:"text",attrs:{size:"large","init-value":t.node.text},on:{confirm:t.handleConfirm}}),n("Icon",{attrs:{size:24,type:"ios-image-outline"}}),n("Dropdown",{attrs:{trigger:"click"},on:{"on-click":t.selectBackground}},[n("Button",{staticClass:"bg-select"},[n("span",[t._v(t._s(t.bgText))]),n("Icon",{attrs:{type:"ios-arrow-down"}})],1),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[n("DropdownItem",{attrs:{name:""}},[t._v("同上节点")]),t._l(t.resources,(function(e,r){return n("DropdownItem",{key:e.uid,attrs:{name:e.uid,divided:!r}},[t._v(t._s(e.name))])}))],2)],1)],1)},z=[],q={name:"LabelNode",components:{BetterInput:I,Dropdown:C["a"],DropdownMenu:j["a"],DropdownItem:_["a"],Button:u["a"],Icon:g["a"]},props:{node:{type:Object,required:!0}},data:function(){return{bgText:"----"}},computed:Object(R["e"])(["resources"]),methods:{selectBackground:function(t){this.$store.commit("updateNode",{uid:this.node.uid,background:t}),this.bgText=t?this.resources.find((function(e){return e.uid===t})).name:"----"},handleConfirm:function(t){this.$store.commit("updateNode",{uid:this.node.uid,text:t})}},mounted:function(){var t=this;this.bgText=this.node.background?this.resources.find((function(e){return e.uid===t.node.background})).name:"----"}},A=q,H=(n("8930"),Object(P["a"])(A,M,z,!1,null,"8216f416",null)),J=H.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"option-node"},[n("Icon",{staticClass:"icon",attrs:{type:"ios-send-outline",size:24}}),n("BetterInput",{staticClass:"text",attrs:{"init-value":t.node.text},on:{confirm:t.handleConfirm}}),n("Icon",{staticClass:"icon",attrs:{type:"ios-arrow-forward"}}),n("Dropdown",{staticClass:"target",attrs:{trigger:"click"},on:{"on-click":t.selectTarget}},[n("Button",{staticClass:"target-button"},[t._v(" "+t._s(t.targetText)+" "),n("Icon",{attrs:{type:"ios-arrow-down"}})],1),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[n("DropdownItem",{attrs:{name:""}},[t._v("----")]),t._l(t.labels,(function(e){return n("DropdownItem",{key:e.uid,attrs:{name:e.uid}},[t._v(t._s(e.text))])}))],2)],1)],1)},V=[],G={name:"OptionNode",components:{BetterInput:I,Icon:g["a"],Dropdown:C["a"],DropdownMenu:j["a"],DropdownItem:_["a"],Button:u["a"]},props:{node:{type:Object,required:!0}},data:function(){return{targetText:"----"}},computed:Object(R["c"])(["labels"]),methods:{selectTarget:function(t){this.targetText=t?this.labels.find((function(e){return e.uid===t})).text:"----",this.$store.commit("updateNode",{uid:this.node.uid,target:t})},handleConfirm:function(t){this.$store.commit("updateNode",{uid:this.node.uid,text:t})}},mounted:function(){var t=this;this.targetText=this.node.target?this.labels.find((function(e){return e.uid===t.node.target})).text:"----"}},K=G,Y=(n("ddaa"),Object(P["a"])(K,F,V,!1,null,"aed04428",null)),W=Y.exports,Q=(n("77ed"),{name:"Node",components:{LineNode:U,LabelNode:J,OptionNode:W,Button:u["a"],Icon:g["a"]},props:{node:{type:Object,required:!0},index:{type:Number,required:!0},labels:{type:Array,required:!1,default:function(){return[]}}},data:function(){return{hover:!1}},computed:{component:function(){switch(this.node.type){case"line":return U;case"label":return J;case"option":return W;default:return U}}},methods:{move:function(t){this.$store.commit("moveNode",{index:this.index,offset:t})},deleteNode:function(){this.$store.commit("deleteNode",{index:this.index})}}}),X=Q,Z=(n("337a"),Object(P["a"])(X,b,h,!1,null,"1c1bd6e8",null)),tt=Z.exports,et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node-overview"},[n("p",{staticClass:"title"},[t._v("大纲")]),n("div",{staticClass:"nodes"},t._l(t.nodes,(function(e){return n("p",{key:e.uid,class:"node-preview "+e.type},[t._v(t._s(t.getShortcut(e)))])})),0)])},nt=[],rt=(n("99af"),{name:"NodeOverview",props:{nodes:{type:Array,required:!0}},computed:Object(R["c"])(["labels"]),methods:{getShortcut:function(t){switch(t.type){case"line":return t.speaker?"".concat(t.speaker,": ").concat(t.text):t.text;case"label":return t.text;case"option":return t.text+(t.target?" > "+this.labels.find((function(e){return e.uid===t.target})).text:"")}}}}),at=rt,ot=(n("cf9f"),Object(P["a"])(at,et,nt,!1,null,"685b68e7",null)),it=ot.exports,st={name:"NodeManager",components:{NodeOverview:it,Node:tt,Layout:p["a"],Content:l["a"],Sider:v["a"],Header:d["a"],Button:u["a"]},computed:Object(R["e"])(["nodes"]),methods:{scrollToBottom:function(){var t=this.$refs.nodeList.$el;t.scrollTop=t.scrollHeight},addNode:function(t){var e=this;this.$store.commit("createNode",{type:t}),this.$nextTick((function(){return e.scrollToBottom()}))}}},ct=st,ut=(n("e3aa"),Object(P["a"])(ct,f,m,!1,null,"15755ca0",null)),lt=ut.exports,dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Layout",[n("Header",{staticClass:"header"},[n("span",{staticClass:"title"},[t._v("资源编辑器")]),n("Button",{staticClass:"button",attrs:{shape:"circle",icon:"ios-add"},on:{click:t.createRes}},[t._v("添加空资源")]),n("Upload",{attrs:{action:"","before-upload":t.createNewRes,multiple:""}},[n("Button",{staticClass:"button",attrs:{shape:"circle",icon:"ios-add-circle-outline"}},[t._v("添加文件资源")])],1)],1),n("Content",{staticClass:"resources"},[n("transition-group",{ref:"resList",staticClass:"resource-list",attrs:{tag:"div","enter-active-class":"animated fadeInRight fast","leave-active-class":"animated zoomOut fast"}},t._l(t.resources,(function(t,e){return n("div",{key:t.uid,staticClass:"resource-wrapper"},[n("Resource",{staticClass:"resource",attrs:{resource:t,index:e}})],1)})),0)],1)],1)},pt=[],ft=(n("ac1f"),n("1276"),n("6906")),mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{staticClass:"resource",attrs:{bordered:!1}},[n("div",{staticClass:"card-header",attrs:{slot:"title"},slot:"title"},[n("BetterInput",{staticClass:"name",attrs:{"init-value":t.resource.name,buttons:!1},on:{confirm:t.confirmName}}),n("Upload",{staticClass:"icon",attrs:{action:"","before-upload":t.uploadFile}},[n("Icon",{attrs:{size:20,type:"ios-open-outline"}})],1),n("Icon",{staticClass:"icon",attrs:{size:20,type:"ios-remove-circle-outline"},on:{click:t.deleteRes}})],1),t.resource.src?n("div",{staticClass:"res-shortcut"},[n("div",{staticClass:"shortcut-wrapper"},[n("img",{attrs:{src:t.resource.src,alt:t.resource.name}})]),n("p",{staticClass:"text-src"},[t._v(t._s(t.resource.src))])]):n("Upload",{staticClass:"no-res",attrs:{action:"",type:"drag","before-upload":t.uploadFile}},[n("Icon",{attrs:{size:"52",type:"ios-open-outline"}}),n("p",[t._v("点击 或 拖动 以上传资源")])],1)],1)},vt=[],bt=n("8b1e"),ht=(n("cb29"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("d0ff"),{uidg:Date.now()}),gt=ht;function Ot(){return gt.uidg++}function yt(t){var e=null;return window.createObjcectURL?e=window.createOjcectURL(t):window.URL?e=window.URL.createObjectURL(t):window.webkitURL&&(e=window.webkitURL.createObjectURL(t)),e}var wt={name:"Resource",components:{BetterInput:I,Icon:g["a"],Card:bt["a"],Upload:ft["a"]},props:{resource:{type:Object,require:!0},index:{type:Number,require:!0}},methods:{confirmName:function(t){this.$store.commit("updateRes",{uid:this.resource.uid,name:t})},deleteRes:function(){this.$store.commit("deleteRes",{index:this.index})},uploadFile:function(t){var e=yt(t);return this.$store.commit("updateRes",{uid:this.resource.uid,src:e}),!1}}},_t=wt,jt=(n("6e7d"),Object(P["a"])(_t,mt,vt,!1,null,"8cccb376",null)),Ct=jt.exports;function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Dt={name:"ResourceManager",components:{Resource:Ct,Layout:p["a"],Header:d["a"],Content:l["a"],Button:u["a"],Upload:ft["a"]},computed:Object(R["e"])(["resources"]),methods:kt({createNewRes:function(t){var e=this,n=yt(t);return this.$store.commit("createRes",{name:t.name.split(".")[0],src:n}),this.$nextTick((function(){return e.scrollToBottom()})),!1},scrollToBottom:function(){var t=this.$refs.resList.$el;t.scrollTop=t.scrollHeight}},Object(R["d"])(["createRes"]))},St=Dt,Pt=(n("406b"),Object(P["a"])(St,dt,pt,!1,null,"9a36e012",null)),Nt=Pt.exports,It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Layout",[n("Header",{staticClass:"header"},[n("span",{staticClass:"title"},[t._v("角色编辑器")]),n("Button",{staticClass:"button",attrs:{icon:"ios-add",shape:"circle"},on:{click:t.createRole}},[t._v("添加新角色")])],1),n("Content",{staticClass:"roles"},[n("transition-group",{ref:"resList",staticClass:"role-list",attrs:{tag:"div","enter-active-class":"animated fadeInRight fast","leave-active-class":"animated zoomOut fast"}},t._l(t.roles,(function(t,e){return n("div",{key:t.uid,staticClass:"role-wrapper"},[n("Role",{staticClass:"role",attrs:{role:t,index:e}})],1)})),0)],1)],1)},Rt=[],Bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{staticClass:"role"},[n("div",{staticClass:"card-header",attrs:{slot:"title"},slot:"title"},[n("Avatar",{attrs:{src:t.avatarSrc}}),n("BetterInput",{staticClass:"name",attrs:{buttons:!1,"init-value":t.role.name},on:{confirm:t.confirmName}}),n("Icon",{attrs:{size:20,type:"ios-remove-circle-outline"},on:{click:t.deleteRole}})],1),n("div",{ref:"body",staticClass:"body"},[n("div",{staticClass:"form-item"},[n("span",{staticClass:"key"},[t._v("头像：")]),n("Select",{staticClass:"value",model:{value:t.avatarUid,callback:function(e){t.avatarUid=e},expression:"avatarUid"}},t._l(t.resources,(function(e){return n("Option",{key:e.uid,attrs:{value:e.uid}},[t._v(t._s(e.name))])})),1)],1),n("div",{staticClass:"form-item"},[n("span",{staticClass:"key"},[t._v("立绘：")]),n("Select",{staticClass:"value",model:{value:t.picUid,callback:function(e){t.picUid=e},expression:"picUid"}},t._l(t.resources,(function(e){return n("Option",{key:e.uid,attrs:{value:e.uid}},[t._v(t._s(e.name))])})),1)],1),n("div",{staticClass:"pic-wrapper"},[t.role.pic?n("img",{staticClass:"pic",attrs:{src:t.picSrc,alt:t.role.name}}):t._e()])])])},$t=[],Et=n("4dc6"),Lt=n("5f81");function Tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tt(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Mt={name:"Role",components:{BetterInput:I,Card:bt["a"],Select:Lt["a"],Option:Et["a"],Avatar:w["a"],Icon:g["a"]},props:{role:{type:Object,require:!0},index:{type:Number,required:!0}},data:function(){return{avatarUid:this.role.avatar,picUid:this.role.pic,avatarSrc:"",picSrc:""}},watch:{avatarUid:function(t){this.updateData({avatar:t}),this.avatarSrc=t?this.resources.find((function(e){return e.uid===t})).src:""},picUid:function(t){this.updateData({pic:t}),this.picSrc=t?this.resources.find((function(e){return e.uid===t})).src:""}},computed:Ut({},Object(R["e"])(["resources"])),methods:{updateData:function(t){this.$store.commit("updateRole",Ut({uid:this.role.uid},t))},confirmName:function(t){this.updateData({name:t})},deleteRole:function(){this.$store.commit("deleteRole",{index:this.index})}},mounted:function(){var t=this;this.$refs.body.parentElement.style.height="100%",this.avatarSrc=this.role.avatar?this.resources.find((function(e){return e.uid===t.role.avatar})).src:"",this.picSrc=this.role.pic?this.resources.find((function(e){return e.uid===t.role.pic})).src:""}},zt=Mt,qt=(n("b38c"),Object(P["a"])(zt,Bt,$t,!1,null,"6da37ca4",null)),At=qt.exports,Ht={name:"RoleManager",components:{Role:At,Layout:p["a"],Header:d["a"],Content:l["a"],Button:u["a"]},computed:Object(R["e"])(["roles"]),methods:{createRole:function(){var t=this;return this.$store.commit("createRole"),this.$nextTick((function(){return t.scrollToEnd()})),!1},scrollToEnd:function(){var t=this.$refs.resList.$el;t.scrollLeft=t.scrollWidth}}},Jt=Ht,Ft=(n("1780"),Object(P["a"])(Jt,It,Rt,!1,null,"1df8409d",null)),Vt=Ft.exports,Gt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Kt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("article",{staticClass:"welcome-text"},[n("h1",[t._v("申明")]),n("p",[t._v("这是一个还未完成的作品，本喵不对任何特性负责哦~")]),n("h1",[t._v("食用方法")]),n("ol",[n("li",[t._v("在资源管理器中，上传文件资源（但是资源无法持久保存，待解决），并给每个资源起一个易于识别的名字。")]),n("li",[t._v("在角色管理器里，创建好角色，最好包括你自己（尽管目前还不一定支持）。")]),n("li",[t._v("然后在管理器中按序添加你想要的剧情节点。")])]),n("p",[t._v("节点有三种：")]),n("ul",[n("li",[n("strong",[t._v("标签")]),t._v(" 这类节点，是一个在节点列表中的标记，标记一个位置，这个位置指向标签下一个节点。在编译后，这个节点会消失，指向它的指针会指向它的下一个台词节点。")]),n("li",[n("strong",[t._v("台词")]),t._v(" 该类节点有两个主要关键点：讲述人 以及 文本。其中讲述人就是之前定义的角色。再编译后他会保留，并且添加至少一个选项，除非它是最后一个节点。")]),n("li",[n("strong",[t._v("选项")]),t._v(" 它是上一个台词节点所包含的选项，它包含一个指向标签的指针。在编译后，呀会被添加到上一个台词节点所表示的台词内。")])]),n("p",[t._v("如果还是不知道怎么用，就去问江奶奶本人吧喵~❤")]),n("h1",[t._v("Todo List")]),n("ul",[n("li",[t._v("修复资源链接在跟新之后不能使用的问题。")]),n("li",[t._v("增加编译功能。")]),n("li",[t._v("增加多选。")]),n("li",[t._v("增加多选状态下的操作（移动、删除等）。")]),n("li",[t._v("制作播放器界面。")])])])}],Yt={name:"Home"},Wt=Yt,Qt=(n("5ffe"),Object(P["a"])(Wt,Gt,Kt,!1,null,"87888bd6",null)),Xt=Qt.exports;function Zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zt(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ee={name:"app",components:{Home:Xt,RoleManager:Vt,ResourceManager:Nt,NodeManager:lt,Layout:p["a"],Header:d["a"],Content:l["a"],Button:u["a"],Modal:c["a"],Input:s["a"]},data:function(){return{page:"home",outputting:!1,inputting:!1,outputData:null,inputData:null}},computed:Object(R["e"])(["name"]),methods:te({importData:function(){var t=JSON.parse(this.inputData);this.$store.commit("fillState",t),this.inputting=!1},exportData:function(){var t=JSON.stringify(this.$store.state);this.outputData=t,this.outputting=!0},copyData:function(){window.navigator.clipboard&&window.navigator.clipboard.writeText?window.navigator.clipboard.writeText(this.outputData):(this.$refs.outputData.select(),window.document.execCommand("Copy"))}},Object(R["b"])(["save","load","test"]))},ne=ee,re=(n("034f"),n("b0a0"),Object(P["a"])(ne,a,o,!1,null,null,null)),ae=re.exports,oe=(n("f8ce"),n("d81d"),n("a434"),{ADD_NODE:"addNode",LOCAL_STORAGE_KEY:"egg-project"});function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ce(t){var e;switch(t){case"label":e={background:0};break;case"line":e={role:0};break;case"option":e={target:0};break;default:throw Error("cannot resolve type: "+t)}return se({type:t,uid:Ot(),text:""},e)}var ue=ce;function le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?le(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function pe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Ot();return de({uid:e,type:"",name:"未命名-"+e,src:""},t)}var fe=pe;function me(){var t=Ot();return{uid:t,name:"合成人-"+t,avatar:0,pic:0}}var ve=me,be=n("2274"),he=n.n(be),ge=n("8312"),Oe=n.n(ge),ye=n("b219"),we=n.n(ye),_e=n("d150"),je=n.n(_e),Ce=n("da62"),xe=n.n(Ce),ke=n("ffbb"),De=n.n(ke),Se=n("e1d5"),Pe=n.n(Se),Ne=n("d378"),Ie=n.n(Ne),Re=n("7d1f"),Be=n.n(Re),$e=n("8d8b"),Ee=n.n($e),Le=n("3530"),Te=n.n(Le),Ue=n("b08d"),Me=n.n(Ue),ze={roles:[{uid:111,name:"洛天依",avatar:211,pic:221},{uid:112,name:"乐正绫",avatar:212,pic:222},{uid:113,name:"乐正龙牙",avatar:213,pic:223},{uid:114,name:"徵羽摩柯",avatar:214,pic:224},{uid:115,name:"墨清弦",avatar:215,pic:225},{uid:116,name:"言和",avatar:216,pic:226}],resources:[{uid:211,name:"洛天依头像",src:he.a},{uid:212,name:"乐正绫头像",src:Oe.a},{uid:213,name:"乐正龙牙头像",src:we.a},{uid:214,name:"徵羽摩柯头像",src:je.a},{uid:215,name:"墨清弦头像",src:xe.a},{uid:216,name:"言和头像",src:De.a},{uid:221,name:"洛天依立绘",src:Pe.a},{uid:222,name:"乐正绫立绘",src:Ie.a},{uid:223,name:"乐正龙牙立绘",src:Be.a},{uid:224,name:"徵羽摩柯立绘",src:Ee.a},{uid:225,name:"墨清弦立绘",src:Te.a},{uid:226,name:"言和立绘",src:Me.a}]},qe=ze;r["a"].use(R["a"]);var Ae=new R["a"].Store({state:{name:"皇帝的新剧本",nodes:[],roles:[],resources:[]},getters:{labels:function(t){return t.nodes.filter((function(t){return"label"===t.type}))},lines:function(t){return t.nodes.filter((function(t){return"line"===t.type}))}},mutations:{updateData:function(t,e){var n=e.arr,r=e.updatedData,a=r.uid,o=n.find((function(t){return t.uid===a}));o&&Object.assign(o,r)},updateNode:function(t,e){Ae.commit("updateData",{arr:t.nodes,updatedData:e})},createNode:function(t,e){var n=e.type;t.nodes.push(ue(n))},deleteNode:function(t,e){var n=e.index;n>=0&&t.nodes.splice(n,1)},moveNode:function(t,e){var n=e.index,r=e.offset;if(-1===r&&n>0||1===r&&n<t.nodes.length-1){var a=t.nodes[n];t.nodes.splice(n,1),t.nodes.splice(n+r,0,a)}},updateRes:function(t,e){Ae.commit("updateData",{arr:t.resources,updatedData:e})},createRes:function(t,e){t.resources.push(fe(e))},deleteRes:function(t,e){var n=e.index;n>=0&&t.resources.splice(n,1)},updateRole:function(t,e){Ae.commit("updateData",{arr:t.roles,updatedData:e})},createRole:function(t){t.roles.push(ve())},deleteRole:function(t,e){var n=e.index;n>=0&&t.roles.splice(n,1)},fillState:function(t,e){Object.assign(t,e)}},actions:{save:function(t){var e=t.state,n=JSON.stringify(e);localStorage.setItem(oe.LOCAL_STORAGE_KEY,n)},load:function(t){var e=t.commit,n=JSON.parse(localStorage.getItem(oe.LOCAL_STORAGE_KEY))||{};e("fillState",n)},test:function(t){var e=t.commit;e("fillState",qe)},uploadNewFiles:function(t,e){var n=t.commit;e.map(yt).forEach((function(t){return n("createRes",{src:t})}))}}}),He=Ae;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(ae)},store:He}).$mount("#app")},"5ffe":function(t,e,n){"use strict";var r=n("4fa5"),a=n.n(r);a.a},"6e7d":function(t,e,n){"use strict";var r=n("30cd"),a=n.n(r);a.a},7150:function(t,e,n){},"7d1f":function(t,e,n){t.exports=n.p+"img/yzly.2a14e3d8.png"},8312:function(t,e,n){t.exports=n.p+"img/yzl.ceb1d362.png"},"85ec":function(t,e,n){},8930:function(t,e,n){"use strict";var r=n("4180"),a=n.n(r);a.a},"8d8b":function(t,e,n){t.exports=n.p+"img/zymk.7aa9b6fc.png"},"9a17":function(t,e,n){"use strict";var r=n("098c"),a=n.n(r);a.a},b08d:function(t,e,n){t.exports=n.p+"img/yh.cfa1c99d.png"},b0a0:function(t,e,n){"use strict";var r=n("452c"),a=n.n(r);a.a},b219:function(t,e,n){t.exports=n.p+"img/yzly.982a13fc.png"},b38c:function(t,e,n){"use strict";var r=n("7150"),a=n.n(r);a.a},cf9f:function(t,e,n){"use strict";var r=n("de0a"),a=n.n(r);a.a},d150:function(t,e,n){t.exports=n.p+"img/zymk.60fb949f.png"},d378:function(t,e,n){t.exports=n.p+"img/yzl.cbc2e7a8.png"},da62:function(t,e,n){t.exports=n.p+"img/mqx.edff5de2.png"},ddaa:function(t,e,n){"use strict";var r=n("4d17"),a=n.n(r);a.a},de0a:function(t,e,n){},e1d5:function(t,e,n){t.exports=n.p+"img/lty.7602073e.png"},e3aa:function(t,e,n){"use strict";var r=n("20de"),a=n.n(r);a.a},ebbf:function(t,e,n){},ffbb:function(t,e,n){t.exports=n.p+"img/yh.0b2d4d24.png"}});
//# sourceMappingURL=app.84113d12.js.map