(this["webpackJsonpcustom-qna"]=this["webpackJsonpcustom-qna"]||[]).push([[0],{210:function(e,t,s){},211:function(e,t,s){},212:function(e,t,s){},225:function(e,t,s){},399:function(e,t,s){"use strict";s.r(t);var i=s(0),n=s.n(i),r=s(26),a=s.n(r),c=(s(210),s(40)),o=s(41),l=s(65),d=s(64),u=(s(211),s(401)),h=s(406),j=s(145),f=s(404),m=s(411),b=s(403),p=s(56),v=s(410),x=s(412),O=s(413),g=s(205),y=s(202),w=(s(212),1);function k(){return w++}function q(e){return e.toString(16).padStart(8,"0")}var I="custom-qns-info",S=new Map,C=new Map;function N(e){S.set(e.qsuid,e)}function M(e){var t=S.get(e)||null;return t||(t=function(e){var t=localStorage.getItem("qs"+q(e));return t?JSON.parse(t):null}(e))&&S.set(e,t),t}function T(e){var t=C.get(e)||null;return t||(t=function(e){var t=localStorage.getItem("up"+q(e));return t?JSON.parse(t):null}(e))&&C.set(e,t),t}function F(e){localStorage.setItem("qs"+q(e.qsuid),JSON.stringify(e))}function P(e){localStorage.setItem("up"+q(e.upuid),JSON.stringify(e))}function U(e){return{itemCount:e.items.length,name:e.name,qsuid:e.qsuid,description:e.description,version:e.version}}function z(e){return{upuid:e.upuid,qsuid:e.qsuid,finishedCount:e.finished.length,hasWork:e.hasWork,work:e.work,date:e.date,lastModified:Date.now()}}var Q=s(76),E=s(188),A=s.n(E),D=new TextEncoder,L=function(){function e(){Object(c.a)(this,e),this.data=[],this.totalByteLength=0}return Object(o.a)(e,[{key:"writeInt16",value:function(e){var t=new ArrayBuffer(2);return new DataView(t).setInt16(0,e),this.data.push(new Uint8Array(t)),this.totalByteLength+=2,this}},{key:"writeInt32",value:function(e){var t=new ArrayBuffer(4);return new DataView(t).setInt32(0,e),this.data.push(new Uint8Array(t)),this.totalByteLength+=4,this}},{key:"writeUTF8",value:function(e){var t=D.encode(e);return this.writeInt16(t.byteLength),this.data.push(new Uint8Array(t)),this.totalByteLength+=t.byteLength,this}},{key:"build",value:function(){var e,t=new ArrayBuffer(this.totalByteLength),s=new Uint8Array(t),i=0,n=Object(Q.a)(this.data);try{for(n.s();!(e=n.n()).done;){for(var r=e.value,a=0;a<r.byteLength;a++)s[i+a]=r[a];i+=r.byteLength}}catch(c){n.e(c)}finally{n.f()}return s}}]),e}(),H=new TextDecoder("UTF-8"),V=function(){function e(t){Object(c.a)(this,e),this.dv=void 0,this.pointer=0,this.dv=t}return Object(o.a)(e,[{key:"readInt16",value:function(){var e=this.dv.getUint16(this.pointer);return this.pointer+=2,e}},{key:"readInt32",value:function(){var e=this.dv.getUint32(this.pointer);return this.pointer+=4,e}},{key:"readUTF8",value:function(){var e=this.readInt16(),t=H.decode(this.dv.buffer.slice(this.pointer,this.pointer+e));return this.pointer+=e,t}}]),e}();function B(e,t){var s=new FileReader;s.onload=function(){var e=s.result;t(function(e){for(var t=new V(new DataView(e)),s=t.readInt32(),i=t.readInt32(),n=t.readUTF8(),r=t.readUTF8(),a=t.readUTF8(),c=[],o=t.readInt32(),l=0;l<o;l++){var d=t.readInt32(),u=t.readUTF8(),h=t.readUTF8(),j=t.readUTF8();c.push({quid:d,question:u,answer:h,hint:j})}return{developmentVersion:s,qsuid:i,version:n,name:r,description:a,items:c}}(e))},s.readAsArrayBuffer(e)}function W(e,t){var s=function(e){var t=new L;t.writeInt32(e.developmentVersion),t.writeInt32(e.qsuid),t.writeUTF8(e.version),t.writeUTF8(e.name),t.writeUTF8(e.description),t.writeInt32(e.items.length);var s,i=Object(Q.a)(e.items);try{for(i.s();!(s=i.n()).done;){var n=s.value;t.writeInt32(n.quid),t.writeUTF8(n.question),t.writeUTF8(n.answer),t.writeUTF8(n.hint||"")}}catch(r){i.e(r)}finally{i.f()}return t.build()}(e);A()(s,e.name+"_"+e.version+"_"+q(e.qsuid)+".bin")}var R=s(6),J=u.a.Header,Y=u.a.Footer,_=u.a.Content,G=h.a.Title,K=h.a.Text,X=function(e){Object(l.a)(s,e);var t=Object(d.a)(s);function s(){return Object(c.a)(this,s),t.apply(this,arguments)}return Object(o.a)(s,[{key:"render",value:function(){var e=this;return Object(R.jsxs)(u.a,{className:"App fill-height",children:[Object(R.jsx)(J,{className:"centerize-container",children:Object(R.jsx)(G,{level:2,style:{margin:"0",color:"#ffffff"},children:"Custom Q&A"})}),Object(R.jsx)(_,{className:"App-content",children:Object(R.jsxs)(j.a,{className:"fill",style:{margin:"0 1em"},children:[Object(R.jsx)(j.a.TabPane,{className:"fill scroll-y",tab:"\u8fdb\u5ea6",children:Object(R.jsx)(f.b,{dataSource:this.props.progresses,renderItem:this.renderUserProgress.bind(this)})},"progresses"),Object(R.jsx)(j.a.TabPane,{className:"fill scroll-y",tab:"\u9898\u96c6",children:Object(R.jsx)(f.b,{dataSource:this.props.sets,header:Object(R.jsxs)(m.b,{direction:"horizontal",className:"centerize-container",children:[Object(R.jsx)(b.a,{showUploadList:!1,onChange:function(t){return B(t.file.originFileObj,(function(t){return e.props.dataModifier.addQnaSet(t,!1)}))},children:Object(R.jsx)(p.a,{type:"primary",children:"\u5bfc\u5165"})}),Object(R.jsx)(p.a,{onClick:function(){return e.props.dataModifier.addQnaSet(function(){var e=k();return{developmentVersion:1,qsuid:e,version:"1.0.0",name:"\u672a\u547d\u540d\u9898\u96c6-"+e,description:"\u521b\u5efa\u4e8e "+(new Date).toLocaleString(),items:[]}}(),!0)},children:"\u65b0\u5efa"})]}),renderItem:this.renderQnaSet.bind(this)})},"sets")]})}),Object(R.jsx)(Y,{children:Object(R.jsx)(m.b,{children:Object(R.jsx)(p.a,{onClick:this.props.saveData,children:"\u5f3a\u5236\u4fdd\u5b58"})})})]})}},{key:"renderUserProgress",value:function(e){var t=this,s=this.props.sets.find((function(t){return t.qsuid===e.qsuid}));return Object(R.jsx)(f.b.Item,{children:Object(R.jsx)(v.a,{className:"fill-width",actions:[Object(R.jsx)(x.a,{onClick:function(){return t.props.dataModifier.resetProgressWork(e)}}),Object(R.jsx)(O.a,{onClick:function(){return t.props.dataModifier.continueProgress(e)}}),Object(R.jsx)(g.a,{onClick:function(){return t.props.dataModifier.removeProgress(e)}})],children:Object(R.jsx)(v.a.Meta,{title:Object(R.jsx)(G,{level:3,children:s?s.name:"\u672a\u77e5\u9898\u96c6"}),description:Object(R.jsxs)("div",{className:"qnaset-info-card",children:[Object(R.jsx)("div",{children:Object(R.jsxs)(m.b,{children:[Object(R.jsxs)(K,{children:["\u7248\u672c:",s?s.version:"?.?.?"]}),Object(R.jsxs)(K,{children:["\u5b8c\u6210:",e.finishedCount," / ",s?s.itemCount:"?"]})]})}),Object(R.jsx)("div",{children:Object(R.jsxs)(m.b,{children:[Object(R.jsxs)(K,{type:"secondary",children:["upuid:",q(e.upuid)]}),Object(R.jsxs)(K,{type:"secondary",children:["qsuid:",s?q(s.qsuid):"???"]})]})})]})})})})}},{key:"renderQnaSet",value:function(e){var t=this;return Object(R.jsx)(f.b.Item,{children:Object(R.jsx)(v.a,{className:"fill-width",actions:[Object(R.jsx)(y.a,{onClick:function(){return t.props.dataModifier.editQnaSet(e)}}),Object(R.jsx)(O.a,{onClick:function(){return t.props.dataModifier.addProgress((s=e.qsuid,{upuid:k(),developmentVersion:1,qsuid:s,finished:[],hasWork:!1,work:[],date:0}),!0);var s}}),Object(R.jsx)(g.a,{onClick:function(){return t.props.dataModifier.removeQnaSet(e)}})],children:Object(R.jsx)(v.a.Meta,{title:Object(R.jsx)(G,{level:3,children:e.name}),description:Object(R.jsxs)("div",{className:"qnaset-info-card",children:[Object(R.jsx)("div",{children:Object(R.jsxs)(m.b,{children:[Object(R.jsxs)(K,{children:["\u7248\u672c:",e.version]}),Object(R.jsxs)(K,{children:["\u9898\u6570:",e.itemCount]}),Object(R.jsxs)(K,{children:["qsuid:",q(e.qsuid)]})]})}),Object(R.jsx)("div",{children:Object(R.jsx)(K,{children:e.description})})]})})})})}}]),s}(n.a.Component),Z=s(408),$=s(409),ee=s(402),te=s(407),se=s(405),ie=s(414),ne=s(415),re=s(416),ae=s(203),ce=s(100),oe=(s(225),s(99));k(),k();var le=s(123),de=s.n(le),ue=u.a.Content,he=u.a.Header,je=u.a.Sider,fe=f.b.Item,me=fe.Meta,be=Z.a.TextArea,pe=h.a.Text,ve=h.a.Title;function xe(e){return{question:e.question||"",answer:e.answer||"",hint:e.hint||""}}var Oe=function(e){Object(l.a)(s,e);var t=Object(d.a)(s);function s(e){var i;return Object(c.a)(this,s),(i=t.call(this,e)).formRef=n.a.createRef(),i.state=Object.assign({},e.set,{currentItem:null,editMeta:!1,itemPreview:null,isUpdateItemPreview:!1}),i}return Object(o.a)(s,[{key:"setCurrentItem",value:function(e){if(this.state.items.findIndex((function(t){return t===e||t.quid===e.quid}))>=0){if(this.state.currentItem){var t,s=this.state.currentItem,i=null===(t=this.formRef.current)||void 0===t?void 0:t.getFieldsValue();i&&this.changeQna({quid:s.quid,question:i.question||s.question,answer:i.answer||s.answer,hint:i.hint||s.hint||""})}this.setState({currentItem:e,editMeta:!1,itemPreview:xe(e)})}}},{key:"render",value:function(){var e=this;return Object(R.jsxs)(u.a,{className:"Editor fill-height",children:[Object(R.jsxs)(he,{className:"d-flex align-items-center",children:[Object(R.jsx)(ve,{level:2,style:{color:"#ffffff",padding:0},children:"\u9898\u96c6\u7f16\u8f91\u5668"}),Object(R.jsx)("span",{className:"flex-1"}),Object(R.jsxs)(m.b,{children:[Object(R.jsx)(p.a,{shape:"round",icon:Object(R.jsx)(ie.a,{}),onClick:this.props.gotoHome,children:"\u4e3b\u9875"}),Object(R.jsx)(b.a,{showUploadList:!1,onChange:function(t){return e.open(t.file.originFileObj)},children:Object(R.jsx)(p.a,{shape:"round",icon:Object(R.jsx)(ne.a,{}),children:"\u6253\u5f00"})}),Object(R.jsx)(p.a,{shape:"round",icon:Object(R.jsx)(re.a,{}),onClick:this.save.bind(this),children:"\u4fdd\u5b58"})]})]}),Object(R.jsxs)(u.a,{children:[Object(R.jsx)(je,{className:"Editor-sider-left fill-height",width:"36vh",children:Object(R.jsxs)("div",{className:"Editor-sider-content fill-height d-flex flex-column",children:[Object(R.jsx)(v.a,{style:{marginTop:".5em"},onClick:this.editMeta.bind(this,!0),children:Object(R.jsx)(v.a.Meta,{avatar:Object(R.jsx)($.a,{size:"large",children:(this.state.name||"").slice(0,2)}),title:Object(R.jsxs)(ve,{level:3,ellipsis:!0,children:[this.state.name," ",this.state.version]}),description:Object(R.jsx)(pe,{ellipsis:!0,children:this.state.description})})}),Object(R.jsx)("div",{className:"list-content flex-1 scroll-y overflow-x-hidden",children:Object(R.jsx)(f.b,{itemLayout:"vertical",dataSource:this.state.items,renderItem:this.renderItem.bind(this)})}),Object(R.jsx)(ee.a,{}),Object(R.jsx)("div",{className:"qna-list-tool-bar",children:Object(R.jsx)(p.a,{icon:Object(R.jsx)(ae.a,{}),onClick:this.addNewQna.bind(this),children:"\u65b0\u5efa"})})]})}),Object(R.jsx)(ue,{className:"Editor-content fill-height scroll-y",children:this.state.editMeta?this.renderMetaEdit():this.renderItemEdit()}),Object(R.jsx)(ee.a,{style:{height:"100%"},type:"vertical"}),Object(R.jsx)(je,{className:"Editor-sider-right fill-height",width:"50vh",children:!this.state.editMeta&&this.state.currentItem?this.renderPreview():null})]})]})}},{key:"renderItem",value:function(e){return Object(R.jsx)(fe,{onClick:this.setCurrentItem.bind(this,e),children:Object(R.jsx)(me,{title:Object(R.jsx)(pe,{ellipsis:!0,children:e.question||"\u65e0\u9898-"+e.quid}),description:Object(R.jsx)(pe,{type:"secondary",ellipsis:!0,children:e.answer})})})}},{key:"renderItemEdit",value:function(){var e,t=this,s=this.state.currentItem;if(null===s)return null;this.state.isUpdateItemPreview||(null===(e=this.formRef.current)||void 0===e||e.setFieldsValue(s));return Object(R.jsxs)("div",{className:"fill-height",children:[Object(R.jsxs)("div",{className:"d-flex",children:[Object(R.jsxs)(te.a,{className:"flex-1",children:[Object(R.jsx)(te.a.Item,{children:Object(R.jsx)("span",{onClick:this.editMeta.bind(this,!0),children:this.state.name})}),Object(R.jsx)(te.a.Item,{children:Object(R.jsxs)("span",{children:["#",s.quid]})})]}),Object(R.jsxs)(pe,{type:"secondary",children:["quid: ",s.quid]})]}),Object(R.jsx)(ee.a,{}),Object(R.jsxs)(se.a,{name:"item",ref:this.formRef,layout:"vertical",initialValues:s,onValuesChange:function(e,s){return t.setState({itemPreview:xe(s),isUpdateItemPreview:!0})},onFinish:function(e){return t.changeQna({quid:s.quid,question:e.question||s.question,answer:e.answer||s.answer,hint:e.hint||s.hint||""})},children:[Object(R.jsx)(se.a.Item,{name:"question",label:"\u95ee\u9898",rules:[{required:!0,message:"\u95ee\u9898\u662f\u5fc5\u987b\u7684"}],children:Object(R.jsx)(be,{autoSize:!0,size:"large"})}),Object(R.jsx)(se.a.Item,{name:"answer",label:"\u7b54\u6848",rules:[{required:!0,message:"\u7b54\u6848\u662f\u5fc5\u987b\u7684"}],children:Object(R.jsx)(be,{autoSize:!0,size:"large"})}),Object(R.jsx)(se.a.Item,{name:"hint",label:"\u63d0\u793a",children:Object(R.jsx)(be,{autoSize:!0,size:"large"})}),Object(R.jsx)(se.a.Item,{children:Object(R.jsxs)(m.b,{className:"fill-width centerize-container",children:[Object(R.jsx)(p.a,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"}),Object(R.jsx)(p.a,{htmlType:"button",onClick:function(){var e;return null===(e=t.formRef.current)||void 0===e?void 0:e.resetFields()},children:"\u91cd\u7f6e"})]})}),Object(R.jsx)(pe,{type:"secondary",children:"\u5f53\u5207\u6362\u5f53\u524d\u7f16\u8f91\u8bcd\u6761\u65f6\u4f1a\u81ea\u52a8\u63d0\u4ea4\u3002"})]})]})}},{key:"renderMetaEdit",value:function(){var e,t=this,s={name:this.state.name,version:this.state.version,description:this.state.description};return null===(e=this.formRef.current)||void 0===e||e.setFieldsValue(s),Object(R.jsxs)("div",{className:"fill-height",children:[Object(R.jsxs)("div",{className:"d-flex",children:[Object(R.jsx)(te.a,{className:"flex-1",children:Object(R.jsx)(te.a.Item,{children:Object(R.jsx)("span",{children:this.state.name})})}),Object(R.jsxs)(pe,{type:"secondary",children:["qsuid: ",this.state.qsuid]})]}),Object(R.jsx)(ee.a,{}),Object(R.jsxs)(se.a,{name:"meta",ref:this.formRef,layout:"horizontal",initialValues:s,onFinish:function(e){return t.setMeta({name:e.name,version:e.version,description:e.description})},children:[Object(R.jsx)(se.a.Item,{name:"name",label:"\u540d\u79f0",rules:[{required:!0,message:"\u540d\u79f0\u662f\u5fc5\u987b\u7684"}],children:Object(R.jsx)(Z.a,{size:"large"})}),Object(R.jsx)(se.a.Item,{name:"version",label:"\u7248\u672c",rules:[{required:!0,message:"\u7248\u672c\u662f\u5fc5\u987b\u7684"}],children:Object(R.jsx)(Z.a,{size:"large",placeholder:"\u5f62\u5982 1.16.5 \u7684\u7248\u672c\u53f7"})}),Object(R.jsx)(se.a.Item,{name:"description",label:"\u63cf\u8ff0",children:Object(R.jsx)(be,{autoSize:!0,size:"large",placeholder:"\u5728\u6b64\u8f93\u5165\u8be5\u9898\u96c6\u7684\u63cf\u8ff0\u4ee5\u53ca\u60f3\u4f20\u8fbe\u7ed9\u4f7f\u7528\u8005\u7684\u4fe1\u606f"})}),Object(R.jsx)(se.a.Item,{children:Object(R.jsxs)(m.b,{className:"fill-width centerize-container",children:[Object(R.jsx)(p.a,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"}),Object(R.jsx)(p.a,{htmlType:"button",onClick:function(){var e;return null===(e=t.formRef.current)||void 0===e?void 0:e.resetFields()},children:"\u91cd\u7f6e"})]})})]})]})}},{key:"renderPreview",value:function(){var e=this.state.itemPreview;return null===e?null:Object(R.jsxs)("div",{className:"preview fill-height d-flex flex-column",children:[Object(R.jsxs)("header",{className:"d-flex align-items-center",style:{background:"#1890ff",padding:".5em"},children:[Object(R.jsx)(p.a,{type:"text",shape:"circle",icon:Object(R.jsx)(ce.a,{}),style:{color:"#ffffff"}}),Object(R.jsx)(pe,{style:{color:"#ffffff"},children:"\u4eca\u65e5\u5b8c\u6210\uff1a14 / 30"}),Object(R.jsx)("span",{className:"flex-1"})]}),Object(R.jsx)(ve,{className:"question",level:3,style:{color:"#595959",marginTop:".5em"},children:e.question}),Object(R.jsx)(ee.a,{}),Object(R.jsxs)("div",{className:"flex-1 scroll-y",children:[Object(R.jsx)(de.a,{children:e.answer}),Object(R.jsx)(pe,{type:"secondary",style:{fontStyle:"italic"},children:e.hint})]}),Object(R.jsxs)(m.b,{size:"middle",direction:"vertical",style:{width:"100%",marginBottom:"2em"},children:[Object(R.jsx)(p.a,{size:"large",shape:"round",type:"primary",block:!0,children:"\u6211\u77e5\u9053"}),Object(R.jsx)(p.a,{size:"large",shape:"round",type:"default",block:!0,children:"\u63d0\u793a\u4e00\u4e0b"})]})]})}},{key:"addNewQna",value:function(){var e={quid:k(),question:"",answer:"",hint:""},t=this.state.items.slice().concat(e);this.setState({items:t,editMeta:!1,currentItem:e,itemPreview:xe(e)}),this.props.set.items=t}},{key:"changeQna",value:function(e){var t,s,i=this.state.items.findIndex((function(t){return t===e||t.quid===e.quid}));if(!(i<0||e.quid!==(null===(t=this.state.currentItem)||void 0===t?void 0:t.quid))){var n=this.state.items.slice();n[i]=e,this.state.currentItem===e||(null===(s=this.state.currentItem)||void 0===s?void 0:s.quid)===e.quid?this.setState({items:n,currentItem:e,itemPreview:xe(e),isUpdateItemPreview:!1}):this.setState({items:n,isUpdateItemPreview:!1}),this.props.set.items=n}}},{key:"editQnaItem",value:function(e){this.setState({editMeta:!1,currentItem:e,itemPreview:xe(e)})}},{key:"editMeta",value:function(){this.setState({editMeta:!0})}},{key:"setMeta",value:function(e){this.setState(e),Object.assign(this.props.set,e)}},{key:"save",value:function(){var e=this.state;W({developmentVersion:1,qsuid:e.qsuid,version:e.version,name:e.name,description:e.description,items:e.items.slice()})}},{key:"open",value:function(e){var t=this;B(e,(function(e){return t.setState({qsuid:e.qsuid,version:e.version,name:e.name,description:e.description,items:e.items,currentItem:e.items[0]||null,editMeta:!1})}))}}]),s}(n.a.Component),ge=s(38);function ye(e,t){for(var s=e.slice(),i=Math.min(t,s.length),n=0;n<i;n++){var r=Math.floor(Math.random()*s.length);if(n!==r){var a=s[n];s[n]=s[r],s[r]=a}}return s.slice(0,i)}var we=h.a.Text,ke=h.a.Title;function qe(e){var t=new Date;return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}var Ie=function(e){Object(l.a)(s,e);var t=Object(d.a)(s);function s(e){var i;Object(c.a)(this,s),i=t.call(this,e);var n=e.progress,r=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(t&&t.hasWork&&t.work&&t.work.length>0&&t.date&&qe(new Date(t.date))){var n=new Map(e.items.map((function(e){return[e.quid,e]})));return t.work.map((function(e){return n.get(e)})).filter((function(e){return!!e}))}var r,a=new Set((null===t||void 0===t?void 0:t.finished)||[]),c=[],o=[],l=Object(Q.a)(e.items);try{for(l.s();!(r=l.n()).done;){var d=r.value;(a.has(d.quid)?o:c).push(d)}}catch(j){l.e(j)}finally{l.f()}var u=ye(o,i),h=ye(c,s);return u.concat.apply(u,Object(oe.a)(h))}(e.set,n),a=n.workCompleteCount||0;return n.date=Date.now(),n.hasWork=!0,n.work=r.map((function(e){return e.quid})),n.workCompleteCount=a,i.state={finished:new Set,work:r,index:a,success:!1,prog:0,allFinished:a>=r.length},i}return Object(o.a)(s,[{key:"render",value:function(){var e,t=this,s={size:"large",shape:"round",block:!0};if(this.state.allFinished)e=Object(R.jsx)("div",{className:"centerize-container fill-height",children:Object(R.jsxs)(m.b,{direction:"vertical",children:[Object(R.jsx)(ke,{children:this.props.progress.finished.length>=this.props.set.items.length?"\u8be5\u9898\u96c6\u5df2\u5168\u90e8\u7b54\u5b8c":"\u4eca\u65e5\u4efb\u52a1\u5b8c\u6210\uff01"}),Object(R.jsx)(p.a,Object(ge.a)(Object(ge.a)({},s),{},{type:"primary",onClick:this.props.gotoHome,children:"\u8fd4\u56de"}))]})});else{var i=this.state.work[this.state.index];e=i?Object(R.jsxs)("div",{className:"d-flex flex-column fill-height",children:[Object(R.jsx)(ke,{className:"question",level:3,style:{color:"#595959",marginTop:".5em"},children:i.question}),Object(R.jsx)(ee.a,{}),Object(R.jsxs)("div",{className:"flex-1 scroll-y",children:[this.state.prog>=2?Object(R.jsx)(de.a,{children:i.answer}):null,this.state.prog>=1?Object(R.jsx)(we,{type:"secondary",style:{fontStyle:"italic"},children:i.hint}):null]}),Object(R.jsxs)(m.b,{size:"middle",direction:"vertical",style:{width:"100%",marginBottom:"2em"},children:[this.state.prog<2?Object(R.jsx)(p.a,Object(ge.a)(Object(ge.a)({},s),{},{type:"primary",onClick:function(){return t.setState({prog:2,success:!0})},children:"\u6211\u77e5\u9053"})):Object(R.jsx)(p.a,Object(ge.a)(Object(ge.a)({},s),{},{type:"primary",onClick:this.nextQuestion.bind(this),children:"\u4e0b\u4e00\u9898"})),this.state.prog<1?Object(R.jsx)(p.a,Object(ge.a)(Object(ge.a)({},s),{},{disabled:!i.hint,onClick:function(){return t.setState({prog:1})},children:"\u63d0\u793a\u4e00\u4e0b"})):this.state.prog<2?Object(R.jsx)(p.a,Object(ge.a)(Object(ge.a)({},s),{},{onClick:function(){return t.setState({prog:2,success:!1})},danger:!0,children:"\u663e\u793a\u7b54\u6848"})):this.state.success?Object(R.jsx)(p.a,Object(ge.a)(Object(ge.a)({},s),{},{onClick:function(){return t.setState({success:!1})},children:"\u6807\u4e3a\u7b54\u9519"})):null]})]}):Object(R.jsx)("div",{className:"centerize-container fill-height",children:"Something goes wrong"})}return Object(R.jsxs)(u.a,{className:"preview fill-height d-flex flex-column",children:[Object(R.jsxs)(u.a.Header,{className:"d-flex align-items-center",style:{background:"#1890ff",padding:".5em",height:"3em"},children:[Object(R.jsx)(p.a,{type:"text",shape:"circle",icon:Object(R.jsx)(ce.a,{}),style:{color:"#ffffff"},onClick:this.props.gotoHome}),Object(R.jsxs)(we,{style:{color:"#ffffff"},children:["\u4eca\u65e5\u5b8c\u6210\uff1a",this.state.index+(this.state.success?1:0)," / ",this.state.work.length]}),Object(R.jsx)("span",{className:"flex-1"})]}),Object(R.jsx)(u.a.Content,{className:"fill-height",children:e})]})}},{key:"nextQuestion",value:function(){var e=this.state.work[this.state.index];if(this.state.success){var t=this.state.index+1;t>=this.state.work.length?this.setState({finished:this.state.finished.add(e.quid),success:!1,index:t,prog:0,allFinished:!0}):this.setState({finished:this.state.finished.add(e.quid),success:!1,index:t,prog:0}),this.onComplete(e,t)}else{var s=this.state.work.slice();s.splice(this.state.index,1),s.push(e),this.setState({work:s,finished:this.state.finished.add(e.quid),success:!1,prog:0})}}},{key:"onComplete",value:function(e,t){var s=this.props.progress;s.finished.push(e.quid),s.finished=Array.from(new Set(s.finished)),s.workCompleteCount=t}}]),s}(n.a.Component);function Se(e){var t=e.error,s=e.gotoHome;return Object(R.jsxs)(m.b,{direction:"vertical",className:"fill centerize-container",children:[Object(R.jsx)(h.a.Text,{type:"danger",children:t}),Object(R.jsx)(p.a,{shape:"round",type:"primary",onClick:s,children:"\u8fd4\u56de"})]})}var Ce=function(e){Object(l.a)(s,e);var t=Object(d.a)(s);function s(e){var i;Object(c.a)(this,s),(i=t.call(this,e)).gotoHome=function(){Array.from(S.values()).forEach((function(e){var t=i.state.sets.find((function(t){return t.qsuid===e.qsuid}));t?(t.name=e.name,t.version=e.version,t.itemCount=e.items.length,t.description=e.description):i.state.sets.push(U(e))})),Array.from(C.values()).forEach((function(e){var t=i.state.progresses.find((function(t){return t.upuid===e.upuid}));t?(t.qsuid=e.qsuid,t.finishedCount=e.finished.length,t.hasWork=!!e.work&&e.work.length>0,t.date=e.date,t.lastModified=e.date||0,t.workCompleteCount=e.workCompleteCount):i.state.progresses.push(z(e))})),i.setState({content:"home"})};var n=function(){var e=localStorage.getItem(I);if(e){var t=JSON.parse(e);return w=t.uidCounter||w,{sets:t.sets,progresses:t.progresses}}return w=0,{sets:[],progresses:[]}}();return i.state={content:"home",sets:n.sets,progresses:n.progresses,editQnaSet:null,runProgress:null},i}return Object(o.a)(s,[{key:"addQnaSet",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.state.sets.find((function(t){return t.qsuid===e.qsuid}))){N(e);var s={sets:this.state.sets.slice().concat(U(e)),content:t?"editor":this.state.content,editQnaSet:t?e:null};this.setState(s)}}},{key:"removeQnaSet",value:function(e){if(window.confirm("\u786e\u5b9a\u5220\u9664"+e.name+"#"+q(e.qsuid)+"\u7684\u8fdb\u5ea6\uff1f\n\u8fd9\u5c06\u5bfc\u81f4\u4f9d\u8d56\u5176\u7684\u8fdb\u5ea6\u5931\u6548\uff01")){var t;t=e.qsuid,S.delete(t),localStorage.removeItem("qs"+q(t));var s=this.state.sets.slice(),i=s.findIndex((function(t){return t.qsuid===e.qsuid}));i>=0&&(s.splice(i,1),this.setState({sets:s}))}}},{key:"editQnaSet",value:function(e){e&&this.setState({content:"editor",editQnaSet:M(e.qsuid)||null})}},{key:"addProgress",value:function(e,t){if(!this.state.progresses.find((function(t){return t.upuid===e.upuid}))){var s;s=e,C.set(s.upuid,s);var i=z(e);this.setState({progresses:this.state.progresses.concat(i),content:t?"excise":this.state.content,runProgress:t?e:null})}}},{key:"removeProgress",value:function(e){if(window.confirm("\u786e\u5b9a\u5220\u9664"+q(e.upuid)+"\u7684\u8fdb\u5ea6\uff1f")){var t;t=e.upuid,C.delete(t),localStorage.removeItem("up"+q(t));var s=this.state.progresses.slice(),i=s.findIndex((function(t){return t.upuid===e.upuid}));i>=0&&(s.splice(i,1),this.setState({progresses:s}))}}},{key:"continueProgress",value:function(e){this.setState({content:"excise",runProgress:T(e.upuid)})}},{key:"setContentType",value:function(e){this.setState({content:e})}},{key:"resetProgressWork",value:function(e){var t=T(e.upuid);t&&(t.hasWork=!1,t.work=[],t.workCompleteCount=0,e.qsuid=t.qsuid,e.finishedCount=t.finished.length,e.hasWork=!!t.work&&t.work.length>0,e.date=t.date,e.lastModified=t.date||0,e.workCompleteCount=t.workCompleteCount,this.setState({content:"excise",runProgress:t}))}},{key:"render",value:function(){var e=null;switch(this.state.content){case"home":e=Object(R.jsx)(X,{dataModifier:this,progresses:this.state.progresses,sets:this.state.sets,saveData:this.saveData.bind(this)});break;case"editor":var t=this.state.editQnaSet;if(!t)return this.renderError("\u672a\u77e5\u9898\u96c6");e=Object(R.jsx)(Oe,{set:t,gotoHome:this.gotoHome});break;case"excise":var s=this.state.runProgress;if(!s)return this.renderError("\u672a\u77e5\u8fdb\u5ea6");var i=M(s.qsuid);if(!i)return this.renderError("\u672a\u77e5\u9898\u96c6\uff1a"+s.qsuid);e=Object(R.jsx)(Ie,{gotoHome:this.gotoHome,set:i,progress:s})}return e}},{key:"renderError",value:function(e){return Object(R.jsx)(Se,{error:e,gotoHome:this.gotoHome})}},{key:"componentWillUnmount",value:function(){this.saveData()}},{key:"saveData",value:function(){var e;e={sets:this.state.sets,progresses:this.state.progresses},localStorage.setItem(I,JSON.stringify(Object.assign(e,{uidCounter:w}))),Array.from(S.values()).forEach(F),Array.from(C.values()).forEach(P)}}]),s}(n.a.Component),Ne=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,417)).then((function(t){var s=t.getCLS,i=t.getFID,n=t.getFCP,r=t.getLCP,a=t.getTTFB;s(e),i(e),n(e),r(e),a(e)}))};a.a.render(Object(R.jsx)(n.a.StrictMode,{children:Object(R.jsx)(Ce,{})}),document.getElementById("root")),Ne()}},[[399,1,2]]]);
//# sourceMappingURL=main.ccdf3c58.chunk.js.map