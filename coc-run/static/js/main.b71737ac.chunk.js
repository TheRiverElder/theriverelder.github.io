(this["webpackJsonpcoc-run"]=this["webpackJsonpcoc-run"]||[]).push([[0],{22:function(t,e,n){},23:function(t,e,n){},24:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n(8),r=n.n(a),s=n(14),o=n.n(s),c=(n(22),n(16)),u=n(7),h=n(0),l=n(1),d=n(12),v=n(3),m=n(2);n(23);function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Array.from(Array(n),(function(){return Math.floor(Math.random()*(t-e)+e)})).reduce((function(t,e){return t+e}),0)}function f(t){return Math.random()<(t>1?t/100:t)}var g=Date.now();function y(){return g++}var b=function(){function t(e){Object(h.a)(this,t),this.map=new Map,e&&this.add.apply(this,Object(u.a)(e))}return Object(l.a)(t,[{key:"add",value:function(){for(var t=this,e=0,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.forEach((function(n){t.map.has(n.uid)||(t.map.set(n.uid,n),e++)})),e}},{key:"remove",value:function(){for(var t=this,e=0,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.forEach((function(n){return e+=t.map.delete("number"===typeof n?n:n.uid)?1:0})),e}},{key:"get",value:function(t){return this.map.get(t)}},{key:"keys",value:function(){return Array.from(this.map.keys())}},{key:"values",value:function(){return Array.from(this.map.values())}},{key:"size",get:function(){return this.map.size}}]),t}(),x=function(){function t(e){var n,i=this;Object(h.a)(this,t),this.id=void 0,this.name=void 0,this.entities=new b,this.onEnterFn=void 0,this.id=e.id,this.name=e.name,this.onEnterFn=e.onEnter||null,null===(n=e.entities)||void 0===n||n.forEach((function(t){i.entities.add(t),t.site=i}))}return Object(l.a)(t,[{key:"onEnter",value:function(t){this.onEnterFn&&("function"===typeof this.onEnterFn?this.onEnterFn(t):t.triggerEvent(this.onEnterFn))}},{key:"addEntity",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.entities.add(e),e.site!==this&&(e.site=this,i||this.entities.values().forEach((function(i){return i.onDetect(t,e,n)}))),this}},{key:"addEntities",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.forEach((function(e){return n.addEntity(t,e,i)})),this}},{key:"removeEntity",value:function(e,n){return this.entities.remove(n.uid),n.site=t.FAKE_SITE,this}},{key:"removeEntities",value:function(t,e){var n=this;return e.forEach((function(e){return n.removeEntity(t,e)})),this}}]),t}();x.FAKE_SITE=new x({id:"__fake_site__",name:"Fake Site",entities:[]});var O=x,j=function(){function t(e){Object(h.a)(this,t),this.id=void 0,this.uid=void 0,this.name=void 0,this.site=void 0,this.id=e.id||"entity",this.uid=e.uid||y(),this.name=e.name,this.site=e.site||O.FAKE_SITE}return Object(l.a)(t,[{key:"onDetect",value:function(t,e,n){}},{key:"goToSite",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.site.removeEntity(t,this),n?e.entities.add(this):e.addEntity(t,this),this.site=e}},{key:"getInteractions",value:function(t){return[]}},{key:"onInteract",value:function(t,e){}}]),t}(),k=function(){function t(e){Object(h.a)(this,t),this.id=void 0,this.priority=void 0,this.uid=void 0,this.id=e.id,this.priority=e.priority||0,this.uid=e.uid||y()}return Object(l.a)(t,[{key:"onStart",value:function(t){t.appendText("\u4e8b\u4ef6[".concat(this.id,"]\u5f00\u59cb\u4e86"))}},{key:"onRender",value:function(t){return[]}},{key:"onInput",value:function(t,e){t.appendText("\u6765\u81ea\u4e8b\u4ef6[".concat(this.id,"]"))}}]),t}(),w=function(){function t(e){Object(h.a)(this,t),this.id=void 0,this.uid=void 0,this.name=void 0,this.id=e.id||"item",this.uid=e.uid||y(),this.name=e.name}return Object(l.a)(t,[{key:"onAttack",value:function(t,e){}},{key:"previewDamage",value:function(t,e){return""}}]),t}(),E=n(5),T=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,Object(E.a)(Object(E.a)({},t),{},{id:t.id||"melee_weapon"}))).damage=void 0,i.damage=t.damage,i}return Object(l.a)(n,[{key:"onAttack",value:function(t,e){var n,i="number"===typeof(n=this.damage)?n:p(n.faces+1,1,n.times)*(n.factor||1)+(n.fix||0);e.mutateValue(t,"health",-i,"\u53d7\u5230".concat(this.name,"\u653b\u51fb"))}},{key:"previewDamage",value:function(t,e){if("number"===typeof this.damage)return String(this.damage);var n=this.damage,i=n.faces,a=n.times,r=n.fix,s=n.factor,o="".concat(a||1,"d").concat(i);return s&&1!==s&&(o="".concat(s,"*(").concat(o,")")),r&&(o+=r>=0?"+"+r:String(r)),o}}]),n}(w),S=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i,a=t.item,r=t.site,s=t.autoEquip;return Object(h.a)(this,n),(i=e.call(this,{id:"item",name:a.name,site:r})).item=void 0,i.autoEquip=void 0,i.item=a,i.autoEquip=s||!1,i}return Object(l.a)(n,[{key:"getInteractions",value:function(){return[{text:"\u6361\u8d77"+this.item.name,leftText:"\ud83d\udc8e",tag:[]}]}},{key:"onInteract",value:function(t,e){this.autoEquip?t.getPlayer().holdItem(t,this.item):t.getPlayer().addItemToInventory(t,this.item),this.site.removeEntity(t,this),t.showPortOptions()}}]),n}(j),I=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i,a=t.target,r=t.site,s=t.timeCost;return Object(h.a)(this,n),(i=e.call(this,{id:"port",name:a,site:r})).target=void 0,i.timeCost=void 0,i.target=a,i.timeCost=s||1,i}return Object(l.a)(n,[{key:"getInteractions",value:function(t){var e,n;return[{text:"\u53bb\u5f80"+((null===(e=t.getMap().get(this.target))||void 0===e?void 0:e.name)||"#ERROR#"),leftText:(null===(n=t.getPlayer().prevSite)||void 0===n?void 0:n.id)===this.target?"\u2b05":"\u27a1",tag:this.uid}]}},{key:"onInteract",value:function(t,e){if(e.tag===this.uid){var n=t.getMap().get(this.target);n&&(t.getPlayer().goToSite(t,n),t.timePass(this.timeCost))}}}]),n}(j),_=n(10),A=n(6);function N(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t&&"object"===typeof t?Array.isArray(t)?e?Object(u.a)(t):t.map(N):e?Object(E.a)({},t):Object.fromEntries(Object.entries(t).map((function(t,e){return[t,N(e)]}))):t}function P(t,e){for(var n=t,i=null,a=0;a<e.length;a++){var r=e[a];if(!n[r])break;i=n,n=n[r]}return{result:n,thisArg:i}}function M(t){return t>=0?"+"+t:String(t)}var C=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i,a;return Object(h.a)(this,n),(a=e.call(this,t)).health=void 0,a.maxHealth=void 0,a.strength=void 0,a.dexterity=void 0,a.baseDamage=void 0,a.baseWeaponName=void 0,a.loots=void 0,a.health=t.health,a.maxHealth=t.maxHealth,a.strength=t.strength,a.dexterity=t.dexterity,a.baseDamage=t.baseDamage,a.baseWeaponName=t.baseWeaponName,a.loots=(null===(i=t.loots)||void 0===i?void 0:i.map((function(t){return t instanceof w?new S({item:t}):t})))||[],a}return Object(l.a)(n,[{key:"mutateValue",value:function(t,e,n,i){switch(e){case"health":this.health+=n;break;case"strength":this.strength+=n;break;case"dexterity":this.dexterity+=n}t.appendText("".concat(this.name," ").concat(i||""," ").concat(t.translate(e)," ").concat(M(n))),this.isAlive()||(t.appendText("".concat(this.name,"\u6b7b\u4ea1")),this.site.addEntities(t,this.loots),this.site.removeEntity(t,this))}},{key:"goToSite",value:function(t,e){t.appendText("".concat(this.name,"\u6765\u5230\u4e86").concat(e.name),"mutate"),Object(_.a)(Object(A.a)(n.prototype),"goToSite",this).call(this,t,e)}},{key:"getWeapon",value:function(){return new T({id:"melee",name:this.baseWeaponName,damage:this.baseDamage})}},{key:"isAlive",value:function(){return this.health>0}}]),n}(j),D=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,Object(E.a)(Object(E.a)({},t),{},{id:"player"}))).money=void 0,i.magic=void 0,i.insight=void 0,i.holdingItem=void 0,i.inventory=new b,i.prevSite=void 0,i.money=t.money,i.magic=t.magic,i.insight=t.insight,i.holdingItem=t.holdingItem,t.inventory.forEach((function(t){return i.inventory.add(t)})),i.prevSite=t.prevSite,i}return Object(l.a)(n,[{key:"mutateValue",value:function(t,e,n,i){switch(e){case"health":this.health+=n;break;case"magic":this.magic+=n;break;case"money":this.money+=n;break;case"strength":this.strength+=n;break;case"insight":this.insight+=n;break;case"dexterity":this.dexterity+=n}t.appendText("".concat(this.name," ").concat(i||""," ").concat(t.translate(e)," ").concat(M(n))),this.isAlive()||t.gameOver("\u5931\u8840\u8fc7\u591a")}},{key:"holdItem",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"restore",i=this.holdingItem;if(this.holdingItem=e,e?(this.inventory.remove(e),t.appendText("".concat(this.name,"\u62ff\u8d77\u4e86").concat(e.name),"mutate")):i&&t.appendText("".concat(this.name,"\u6536\u8d77\u4e86").concat(i.name),"mutate"),i)switch(n){case"drop":this.site.addEntity(t,new S({item:i}));break;case"restore":this.inventory.add(i)}}},{key:"goToSite",value:function(t,e){this.prevSite=this.site,Object(_.a)(Object(A.a)(n.prototype),"goToSite",this).call(this,t,e)}},{key:"addItemToInventory",value:function(t,e){return!!this.inventory.add(e)&&(t.appendText("".concat(this.name,"\u83b7\u5f97\u4e86").concat(e.name),"mutate"),!0)}},{key:"removeItemFromInventory",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"drop";if("number"===typeof e){var i=this.inventory.get(e);if(!i)return!1;e=i}if(!this.inventory.remove(e))return!1;switch(n){case"drop":this.site.addEntity(t,new S({item:e,site:this.site}))}return t.appendText("".concat(this.name,"\u5931\u53bb\u4e86").concat(e.name),"mutate"),!0}},{key:"getWeapon",value:function(){return this.holdingItem||Object(_.a)(Object(A.a)(n.prototype),"getWeapon",this).call(this)}},{key:"getInteractions",value:function(){return[]}}]),n}(C),L=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,Object(E.a)(Object(E.a)({},t),{},{priority:10}))).enemy=void 0,i.enemy=t.enemy,i}return Object(l.a)(n,[{key:"onStart",value:function(t){t.appendText("\u5728\u4f60\u9762\u524d\u7684\u662f\u4e00\u4e2a\u5982\u6697\u591c\u822c\u6f06\u9ed1\u7684\u602a\u7269\u2014\u2014".concat(this.enemy.name,"(").concat(this.enemy.health,"/").concat(this.enemy.maxHealth,")"))}},{key:"onRender",value:function(t){var e=t.getPlayer(),n=e.getWeapon().previewDamage(t,this.enemy);return[{text:"\u653b\u51fb",leftText:"\ud83d\udde1",rightText:"".concat(n,"\u2665"),tag:"attack"},{text:"\u9003\u8dd1",leftText:"\ud83c\udfc3\u200d",rightText:"".concat(e.dexterity,"%"),tag:"escape"}].concat(t.debugMode?[{text:"\u4e00\u51fb\u5fc5\u6740",leftText:"\ud83d\udcbb",rightText:"\u8c03\u8bd5\u6a21\u5f0f",tag:"one_punch"}]:[])}},{key:"onInput",value:function(t,e){var n=!1,i=t.getPlayer(),a=this.enemy;if("one_punch"===e.tag)a.mutateValue(t,"health",-a.health,"\u56e0\u4e3a\u82df\u7ba1\u7406");else if("attack"===e.tag){if(f(this.enemy.dexterity))t.appendText(this.enemy.name+"\u8eb2\u5f00\u4e86\u4f60\u7684\u653b\u51fb"),f(this.enemy.dexterity)&&(t.appendText("\u5e76\u7ed9\u4e86\u4f60\u4e00\u62f3"),a.getWeapon().onAttack(t,i));else i.getWeapon().onAttack(t,a)}else"escape"===e.tag&&(f(i.dexterity)||!f(a.dexterity)?(n=!0,t.appendText("\u4f60\u9003\u4e86\u51fa\u53bb"),t.endEvent(this)):(t.appendText("\u4f60\u6ca1\u6709\u9003\u8dd1\u6210\u529f"),f(this.enemy.strength)&&(t.appendText("\u800c\u4e14\u8fd8\u88ab\u722a\u5b50\u6293\u4f24"),a.getWeapon().onAttack(t,i))));this.enemy.health<=0?(t.appendText("\u4f60\u6253\u8d25\u4e86"+this.enemy.name),t.endEvent(this)):n?t.appendText("\u4f60\u6210\u529f\u9003\u79bb\u4e86".concat(this.enemy.name,"\u7684\u8ffd\u6740")):(t.appendText("".concat(this.enemy.name,"\u4f9d\u7136\u5b58\u6d3b(").concat(this.enemy.health,"/").concat(this.enemy.maxHealth,")")),t.appendText("\u5230\u4e86".concat(this.enemy.name,"\u7684\u56de\u5408")),f(t.getPlayer().dexterity)?t.appendText("\u4f60\u9003\u8fc7\u4e86\u5b83\u7684\u5077\u88ad"):(t.appendText("\u4f60\u88ab\u722a\u5b50\u6293\u4f24"),a.getWeapon().onAttack(t,i)))}}]),n}(k),F=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(){return Object(h.a)(this,n),e.call(this,{id:"inventory",priority:10})}return Object(l.a)(n,[{key:"onStart",value:function(t){var e=t.getPlayer();t.setOptions([{text:"\u8fd4\u56de",tag:[]}].concat(Array.from(e.inventory.values(),(function(t){var n,i;return{text:((null===(n=e.holdingItem)||void 0===n?void 0:n.uid)===t.uid?"\u5378\u4e0b":"\u88c5\u5907")+t.name,tag:["currentState","player","holdItem",[(null===(i=e.holdingItem)||void 0===i?void 0:i.uid)===t.uid?t:null]]}}))))}},{key:"onRender",value:function(t){var e=t.getPlayer(),n=[{text:"\u8fd4\u56de"}].concat(Object(u.a)(e.inventory.values().map((function(e){return{text:"\u62ff\u4e0a"+e.name,leftText:"\ud83e\udd1c",rightText:e.previewDamage(t),tag:e.uid}}))));return e.holdingItem&&n.splice(1,0,{text:"\u6536\u8d77"+e.holdingItem.name,leftText:"\ud83e\udd1a",rightText:e.holdingItem.previewDamage(t),tag:e.holdingItem.uid}),n}},{key:"onInput",value:function(t,e){if("number"===typeof e.tag){var n,i=e.tag,a=t.getPlayer();if(i===(null===(n=a.holdingItem)||void 0===n?void 0:n.uid))a.holdItem(t,null);else{var r=a.inventory.get(e.tag);r&&a.holdItem(t,r)}}t.endEvent(this)}}]),n}(k);function W(t){var e=t.className,n=t.option,a=t.onClick;return Object(i.jsxs)("button",{className:e,onClick:a,children:[n.leftText?Object(i.jsx)("span",{className:"option-side-text left",children:n.leftText}):null,n.text,n.rightText?Object(i.jsx)("span",{className:"option-side-text right",children:n.rightText}):null]})}var R=["magic","money","insight","strength","dexterity"],H=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,t)).debugMode=void 0,i.textListEl=void 0,i.resetting=!1,i.textBuffer=[],i.pid=null,i.gameOverMessage="",i.currentState=void 0,i.debugMode=t.debugMode||!1,i.textListEl=r.a.createRef(),i.currentState=t.data.initialize(),i.state=Object.assign({},i.currentState,{textList:[],showOptions:!0,showInventory:!1}),i.props.data.start(Object(d.a)(i)),i}return Object(l.a)(n,[{key:"render",value:function(){var t=this,e=this.state,n=e.player;return Object(i.jsxs)("div",{className:"App",children:[Object(i.jsxs)("header",{className:"state-bar",children:[Object(i.jsxs)("p",{children:[Object(i.jsxs)("span",{children:["\u7b2c",Math.floor(e.time/24)+1,"\u5929",e.time%24,"\u70b9\u949f\uff0c"]}),Object(i.jsxs)("span",{children:["\u5728",n.site.name,"\uff0c"]}),Object(i.jsx)("span",{children:n.holdingItem?"\u624b\u6301".concat(n.holdingItem.name,"(").concat(n.holdingItem.previewDamage(this),")"):"\u4e24\u624b\u7a7a\u7a7a"})]}),Object(i.jsxs)("p",{className:"values",children:[Object(i.jsx)("span",{className:"value",children:"".concat(this.translate("health"),":").concat(n.health,"/").concat(n.maxHealth)}),R.map((function(e){return"".concat(t.translate(e),":").concat(n[e])})).map((function(t){return Object(i.jsx)("span",{className:"value",children:t},t)}))]})]}),Object(i.jsxs)("div",{className:"panel",children:[Object(i.jsx)("div",{className:"text-panel",ref:this.textListEl,children:this.state.textList.map((function(t,e){var n;return Object(i.jsx)("p",{className:"text "+(null===(n=t.types)||void 0===n?void 0:n.join(" "))||!1,children:Object(i.jsx)("span",{className:"content",children:t.text})},e)}))}),Object(i.jsx)("div",{className:"option-panel",children:this.state.showOptions?this.state.options.map((function(e,n){return Object(i.jsx)(W,{className:"option",option:e,onClick:t.handleClickOption.bind(t,e,n)},n)})):Object(i.jsx)("button",{className:"option skip-btn",onClick:this.flushText.bind(this,!0),children:" -=\u5feb\u8fdb=- "})})]})]})}},{key:"flushText",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.textBuffer.splice(0,e?this.textBuffer.length:1);this.setState((function(t){return{textList:t.textList.concat(n).slice(-100)}}),(function(){var e;return null===(e=t.textListEl.current)||void 0===e?void 0:e.scrollTo({top:t.textListEl.current.scrollHeight,behavior:"smooth"})}))}},{key:"flushLoop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===this.pid?(this.setState((function(){return{showOptions:!1}})),this.flushText(),this.pid=setInterval(this.flushLoop.bind(this,!0),350)):t&&(this.textBuffer.length?(this.setState((function(){return{showOptions:!1}})),this.flushText()):(clearInterval(this.pid),this.pid=null,this.setState((function(){return{showOptions:!0}}))))}},{key:"appendText",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var r=!1;"string"!==typeof t&&(r=t.translated||!1,i=t.types||i,t=t.text);var s=(t=r?this.translate(t):t).split("\n").map((function(t){return t.trim()})).filter((function(t){return!/^\s*$/.test(t)})),o=s.map((function(t){return{text:t,types:i}}));(e=this.textBuffer).push.apply(e,Object(u.a)(o)),this.flushLoop()}},{key:"setOptions",value:function(t){this.currentState.options=t}},{key:"timePass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?this.currentState.time=24*(Math.floor(this.currentState.time/24)+1)+t%24:this.currentState.time+=t,this.currentState.time}},{key:"reset",value:function(){this.resetting=!0,this.currentState=this.props.data.initialize();var t=this.currentState.player;t.site.addEntity(this,t),this.setState(this.currentState),this.refreshOptions(),this.resetting=!1,this.appendText("\u5f00\u59cb\u6e38\u620f","system"),this.props.data.start(this),this.applyChange()}},{key:"takeScreenshot",value:function(){var t=this.state,e=(t.textList,t.showOptions,Object(c.a)(t,["textList","showOptions"]));this.currentState=N(e,!0)}},{key:"applyChange",value:function(){this.setState(this.currentState)}},{key:"gameOver",value:function(t){this.gameOverMessage="\u6e38\u620f\u7ed3\u675f "+t,this.resetting=!0}},{key:"handleClickOption",value:function(t,e){this.appendText(t.text,"self"),this.showPortOptions();var n=this.currentState;if("__reset__"===t.tag)this.reset();else if("__inventory__"===t.tag)this.triggerEvent(new F);else if(n.events.length>0){n.events[n.events.length-1].onInput(this,t)}else if(t.entityUid){var i=n.player.site.entities.get(t.entityUid);i&&i.onInteract(this,t)}else Array.isArray(t.tag)&&this.execCmd(t.tag);this.refreshOptions(),this.resetting&&(this.appendText(this.gameOverMessage,"system"),this.setOptions([{text:"\u91cd\u6765",tag:"__reset__"}])),this.applyChange()}},{key:"execCmd",value:function(t){var e=t.slice(0,t.length-1),n=t[t.length-2]||[],i=P(this,e),a=i.result,r=i.thisArg;"function"===typeof a&&a.apply(r,n)}},{key:"triggerEvent",value:function(t){var e=this.currentState.events;e.push(t),this.currentState.events=e.sort((function(t,e){return t.priority-e.priority})),t.onStart(this)}},{key:"endEvent",value:function(t){var e=this.currentState.events.findIndex((function(e){return e.uid===t.uid}));e>=0&&this.currentState.events.splice(e,1),this.refreshOptions()}},{key:"refreshOptions",value:function(){var t=this.currentState;if(t.events.length>0){var e=t.events[t.events.length-1];this.setOptions(e.onRender(this))}else this.showPortOptions()}},{key:"showPortOptions",value:function(){var t=this,e=this.currentState.player,n=e.site,i=Array.from(n.entities.values(),(function(e){return e.getInteractions(t).map((function(t){return Object.assign(t,{entityUid:e.uid})}))})).flat(),a=e.inventory.size+(e.holdingItem?1:0),r={text:"\u7269\u54c1\u680f",leftText:"\ud83d\udcb0",rightText:"\u5171".concat(a,"\u4e2a"),tag:"__inventory__"};this.setOptions(a?[].concat(Object(u.a)(i),[r]):i)}},{key:"getPlayer",value:function(){return this.currentState.player}},{key:"getMap",value:function(){return this.currentState.map}},{key:"translate",value:function(t){return this.props.data.translate(t)}},{key:"componentDidMount",value:function(){this.reset()}}]),n}(r.a.Component),q=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,25)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,r=e.getLCP,s=e.getTTFB;n(t),i(t),a(t),r(t),s(t)}))},B=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){return Object(h.a)(this,n),e.call(this,Object(E.a)(Object(E.a)({},t),{},{id:"monster"}))}return Object(l.a)(n,[{key:"onDetect",value:function(t,e,n){("player"===e.id||e instanceof D)&&t.triggerEvent(new L({id:"combat",enemy:this}))}}]),n}(C),z=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,{id:"site_investigation",name:"site_investigation"})).results=void 0,i.counter=void 0,i.chances=void 0,i.results=t.results,i.counter=t.counter||0,i.chances=t.chances||2,i}return Object(l.a)(n,[{key:"getInteractions",value:function(t){return[{text:"\u8c03\u67e5".concat(this.site.name),leftText:"\ud83d\udca1",rightText:"\u7b2c".concat(this.counter+1,"\u6b21")}]}},{key:"onInteract",value:function(t,e){var n=this.site;this.counter++,this.counter>=this.chances&&n.removeEntity(t,this),f(t.getPlayer().insight)?(t.appendText("\u4f60\u4f3c\u4e4e\u5bdf\u89c9\u5230\u4e86\u4ec0\u4e48"),n.removeEntity(t,this),n.addEntities(t,this.results,!0)):this.counter>=this.chances?(t.appendText("\u597d\u50cf\u6ca1\u53d1\u73b0\u4ec0\u4e48\uff0c\u653e\u5f03\u5427"),t.appendText("\u4f60\u5931\u53bb\u4e86\u5bf9".concat(n.name,"\u7684\u5174\u8da3"),"mutate")):t.appendText("\u6ca1\u4ec0\u4e48\u7279\u522b\u7684")}}]),n}(j),U=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i,a=t.event,r=t.once,s=t.option;return Object(h.a)(this,n),(i=e.call(this,{id:"event_trigger",name:a.id})).event=void 0,i.option=void 0,i.once=void 0,i.event=a,i.option=s||{text:"..."},i.once=r||!0,i}return Object(l.a)(n,[{key:"getInteractions",value:function(t){return[this.option]}},{key:"onInteract",value:function(t,e){t.triggerEvent(this.event),this.once&&this.site.removeEntity(t,this)}}]),n}(j),V=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,{id:"text",priority:10})).texts=void 0,i.texts=t.texts,i}return Object(l.a)(n,[{key:"onStart",value:function(t){this.texts.forEach((function(e){return t.appendText(e)})),t.endEvent(this)}}]),n}(k),K=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,{id:"sequence",priority:0})).events=void 0,i.joints=void 0,i.pointer=0,i.events=t.events,i.joints=Array(i.events.length-1).fill(0).map((function(e,n){var i;return(null===(i=t.joints)||void 0===i?void 0:i[n])||{text:"..."}})),i}return Object(l.a)(n,[{key:"nextEvent",value:function(t){if(this.pointer>=this.events.length)t.endEvent(this);else{var e=this.events[this.pointer++];t.triggerEvent(e)}}},{key:"onStart",value:function(t){this.nextEvent(t)}},{key:"onRender",value:function(t){return[this.joints[this.pointer-1]]}},{key:"onInput",value:function(t,e){this.nextEvent(t)}}]),n}(k),J=function(t){Object(v.a)(n,t);var e=Object(m.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,{id:"game_over",priority:10})).reason=void 0,i.reason=t.reason,i}return Object(l.a)(n,[{key:"onStart",value:function(t){t.gameOver(this.reason)}}]),n}(k),$={text:{money:"\u786c\u5e01",health:"\u4f53\u529b",magic:"\u9b54\u529b",strength:"\u529b\u91cf",dexterity:"\u654f\u6377",insight:"\u6d1e\u5bdf"},story:{end:"\n            \u4f60\u53d1\u73b0\u4e86\u5730\u4e0b\u6709\u4e00\u6761\u6697\u9ed1\u7684\u6cb3\u6d41\uff0c\u751a\u81f3\u624b\u7535\u7b52\u7684\u5173\u8054\u90fd\u4e0d\u80fd\u7167\u4eae\u5b83\u4e00\u6beb\n            \u4eff\u4f5b\u6709\u4e00\u79cd\u58f0\u97f3\u5728\u53ec\u5524\u4f60\uff0c\u8ba9\u4f60\u5411\u5b83\u9760\u8fd1\n            \u6b63\u5728\u601d\u8003\u773c\u524d\u7684\u4e00\u5207\u65f6\uff0c\u4f60\u5df2\u7ecf\u6765\u5230\u4e86\u6697\u6cb3\u8fb9\n            \u4f60\u8df3\u5165\u4e86\u8fd9\u6761\u6cb3\u6d41\n            \u6ca1\u6709\u4e00\u4e1d\u4e1d\u51b0\u51c9\u6216\u6eba\u6c34\u7684\u75db\u82e6\uff0c\u4e5f\u6ca1\u6709\u4efb\u4f55\u5176\u5b83\u611f\u89c9\n            \u4f60\u80fd\u611f\u53d7\u5230\u6cb3\u6c34\u5e26\u7740\u4f60\u98d8\u5411\u4e86\u65e0\u5c3d\u7684\u9ed1\u6697\u6df1\u6e0a\n            \u53ef\u662f\u4f60\u5374\u4e1d\u6beb\u4e0d\u60f3\u53cd\u6297\n            \u4e0d\u77e5\u9053\u8fc7\u4e86\u591a\u4e45\u540e\uff0c\u4f60\u9192\u4e86\n            \u5728\u6e05\u6668\u7684\u9633\u5149\u4e2d\uff0c\u75c5\u5e8a\u4e0a\u7684\u4f60\u7741\u5f00\u53cc\u773c\n            \u8be2\u95ee\u62a4\u58eb\u7684\u7ed3\u679c\u662f\uff0c\u6709\u4eba\u5728\u6d77\u8fb9\u53d1\u73b0\u4e86\u4f60\uff0c\u795e\u5fd7\u4e0d\u6e05\n        "}};function G(){return 5*p(7,1,3)}var Q={initialize:function(){var t=[new O({id:"bus_stop",name:"\u5df4\u58eb\u8f66\u7ad9",entities:[new I({target:"ng_bridge"})],onEnter:function(t){return t.setOptions([{text:"\u5230\u6751\u5b50\u91cc\u53bb",tag:["player","goToSite",["hs_village"]]},{text:"\u56de\u57ce\u91cc",tag:["gameOver",["\u5c0f\u6c5f\u5750\u4e0a\u4e86\u79bb\u5f00\u7684\u5df4\u58eb\u3002"]]}])}}),new O({id:"ng_bridge",name:"\u9f10\u6c9f\u6865",entities:[new I({target:"hs_village"})]}),new O({id:"hs_village",name:"\u7074\u5c71\u6751",entities:[new I({target:"main_streat"}),new I({target:"ng_bridge"})]}),new O({id:"main_streat",name:"\u5927\u8def",entities:[new I({target:"temple"}),new I({target:"wang_house"}),new I({target:"ng_bridge"}),new S({item:new T({id:"bone",name:"\u732a\u9aa8",damage:3}),autoEquip:!0})]}),new O({id:"wang_house",name:"\u738b\u5c60\u6237\u5bb6",entities:[new I({target:"main_streat"}),new z({results:[new S({item:new T({name:"\u6740\u732a\u5200",damage:{faces:3,times:2,fix:-1}}),autoEquip:!0})]})]}),new O({id:"temple",name:"\u7960\u5802",entities:[new I({target:"temple_basement"}),new I({target:"main_streat"})]}),new O({id:"temple_basement",name:"\u7960\u5802\u5730\u4e0b\u5ba4",entities:[new I({target:"temple"}),new B({name:"\u89e6\u624b\u602a",baseDamage:{faces:2,fix:1},baseWeaponName:"\u722a\u5b50",health:10,maxHealth:10,strength:30,dexterity:40,loots:[new I({target:"dark_river"})]})]}),new O({id:"dark_river",name:"\u6f06\u9ed1\u4e4b\u6cb3",entities:[new I({target:"temple_basement"}),new U({option:{text:"\u8df3\u5165\u5176\u4e2d",leftText:"\ud83c\udfca\u200d"},event:new K({events:[new V({texts:[{text:"story.end",translated:!0}]}),new J({reason:"\u5b8c\u7f8e\u901a\u5173"})],joints:[{text:"\u7ed3\u675f\u4e86"}]})})]}),new O({id:"hospital",name:"\u533b\u9662"})],e=new Map;t.map((function(t){return e.set(t.id,t)}));var n=p(10)+5;return{events:[],map:e,options:[],time:0,player:new D({id:"player",name:"\u738b\u4e8c\u72d7",site:e.get("bus_stop"),money:G(),health:n,maxHealth:n,magic:G(),strength:G(),dexterity:G(),insight:G(),holdingItem:null,inventory:[],baseDamage:1,baseWeaponName:"\u62f3\u5934"})}},start:function(t){t.appendText("\u4f60\u662f\u5c0f\u6c5f\uff0c\u5c11\u5c0f\u79bb\u6751\u53bb\u4e86\u57ce\u91cc\uff0c\u4e0d\u5e38\u56de\u6765\uff0c\u6700\u8fd1\u5bb6\u91cc\u8bf4\u6709\u4e8b\u60c5\u627e\u4f60\uff0c\u7acb\u523b\u56de\u53bb\uff0c\u4e8e\u662f\u4f60\u6536\u62fe\u597d\u4e86\u884c\u88c5\u3002")},translate:function(t){return function(t,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").split(n).concat(e.split(n)).filter((function(t){return""!==t}));return P(t,i).result}($,t,t.indexOf(".")>=0?"":"text")||t}},X=n(15);(function(){Object.fromEntries||(Object.fromEntries=function(t){for(var e={},n=0;n<t.length;n++){var i=t[n];e[i[0]]=i[1]}return e}),Array.prototype.flat||(Array.prototype.flat=function(t){var e,n=[],i=Object(X.a)(this);try{for(i.s();!(e=i.n()).done;){var a=e.value;n=n.concat(a)}}catch(r){i.e(r)}finally{i.f()}return n})})(),o.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(H,{data:Q,debugMode:"true"===new URLSearchParams(window.location.search).get("debug-mode")})}),document.getElementById("root")),q()}},[[24,1,2]]]);
//# sourceMappingURL=main.b71737ac.chunk.js.map