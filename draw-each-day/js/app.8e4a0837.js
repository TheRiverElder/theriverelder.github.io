(function(r){function n(n){for(var e,i,c=n[0],s=n[1],l=n[2],d=0,f=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(e in s)Object.prototype.hasOwnProperty.call(s,e)&&(r[e]=s[e]);u&&u(n);while(f.length)f.shift()();return a.push.apply(a,l||[]),t()}function t(){for(var r,n=0;n<a.length;n++){for(var t=a[n],e=!0,c=1;c<t.length;c++){var s=t[c];0!==o[s]&&(e=!1)}e&&(a.splice(n--,1),r=i(i.s=t[0]))}return r}var e={},o={app:0},a=[];function i(n){if(e[n])return e[n].exports;var t=e[n]={i:n,l:!1,exports:{}};return r[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=r,i.c=e,i.d=function(r,n,t){i.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:t})},i.r=function(r){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},i.t=function(r,n){if(1&n&&(r=i(r)),8&n)return r;if(4&n&&"object"===typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&n&&"string"!=typeof r)for(var e in r)i.d(t,e,function(n){return r[n]}.bind(null,e));return t},i.n=function(r){var n=r&&r.__esModule?function(){return r["default"]}:function(){return r};return i.d(n,"a",n),n},i.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},i.p="/draw-each-day/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=n,c=c.slice();for(var l=0;l<c.length;l++)n(c[l]);var u=s;a.push([0,"chunk-vendors"]),t()})({0:function(r,n,t){r.exports=t("56d7")},"034f":function(r,n,t){"use strict";var e=t("85ec"),o=t.n(e);o.a},"1f0e":function(r,n,t){r.exports=t.p+"img/settings.c966f992.svg"},2325:function(r,n,t){"use strict";var e=t("71f8"),o=t.n(e);o.a},"28fe":function(r,n,t){},"452c":function(r,n,t){},"56d7":function(r,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var e=t("2b0e"),o=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("div",{attrs:{id:"app"}},[t("TopBar",{attrs:{title:"阿卡姆事务局"}}),t("div",{staticClass:"content"},[r.profile.storage.length?r._e():t("p",[r._v("当前还没有任何卡片！")]),r._l(r.profile.storage,(function(r){return t("Card",{key:r.uid,attrs:{card:r}})}))],2),t("div",{staticClass:"message-list"},r._l(r.messages,(function(n){return t("p",{key:n},[r._v(r._s(n))])})),0),t("div",{staticClass:"setting-button",on:{click:function(n){r.configureSettings=!0}}},[t("img",{attrs:{src:r.icons.settings}})]),r.configureSettings?t("Overlay",{on:{"exit-overlay":function(n){r.configureSettings=!1}}},[t("Settings")],1):r._e()],1)},a=[],i=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("div",{ref:"root",staticClass:"card"},[t("div",{staticClass:"title"},[r._v(r._s(r.fullName))]),r._m(0),t("div",{staticClass:"description"},[t("p",[r._v("住址："+r._s(r.address))]),t("p",[r._v("神器："+r._s(r.artifact))]),t("p",[r._v(r._s(r.story))])])])},c=[function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("div",{staticClass:"divider"},[t("div",{staticClass:"divider-line"}),t("div",{staticClass:"divider-content"}),t("div",{staticClass:"divider-line"})])}],s=(t("b0c0"),t("13d5"),[{id:"normal",text:"",color:"#cccccc",weight:30},{id:"fine",text:"卓越",color:"#52a3cc",weight:1},{id:"extraordinary",text:"超凡",color:"#ccbe52",weight:5},{id:"blessed",text:"神祝",color:"#800000",weight:15},{id:"chaos",text:"混沌",color:"#99718d",weight:1},{id:"dirty",text:"污秽",color:"#9fcc5f",weight:1},{id:"wise",text:"智慧之",color:"#881bcc",weight:1},{id:"hermit",text:"隐者",color:"#cc3547",weight:10},{id:"wind",text:"疾风",color:"#cc9b68",weight:1},{id:"king",text:"大王",color:"#04cc2c",weight:1},{id:"voodoo",text:"巫毒",color:"#6f6099",weight:1},{id:"fairy",text:"仙子",color:"#cc41ae",weight:1},{id:"fallen",text:"堕落的",color:"#595959",weight:1},{id:"demigod",text:"半神",color:"#ccc383",weight:1},{id:"heaven",text:"天子",color:"#ccbf06",weight:1},{id:"week",text:"弱小",color:"#6eccad",weight:1},{id:"shaman",text:"萨满",color:"#64cc5e",weight:1},{id:"strong",text:"强健",color:"#cc6600",weight:1},{id:"great",text:"伟大",color:"#2369cc",weight:1}].reduce((function(r,n){return r[n.id]=n,r}),{})),l={name:"Card",props:["card"],data:function(){return this.card},computed:{fullName:function(){var r=s[this.affixId];return r.text+this.name}},mounted:function(){this.$refs.root.style.background=this.card.color}},u=l,d=(t("2325"),t("2877")),f=Object(d["a"])(u,i,c,!1,null,"6b063b0f",null),p=f.exports,v=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("div",{ref:"topBar",class:r.topBarClass},[t("p",{staticClass:"top-bar-title"},[r._v("阿卡姆侦探事务所")]),t("p",{staticClass:"top-bar-content"},[r._v("账户余额："+r._s(r.profile.account))]),t("div",{staticClass:"draw-panel"},[t("button",{staticClass:"hollow",attrs:{disabled:!r.canDraw},on:{click:r.drawCard}},[r._v("抽卡")]),t("input",{directives:[{name:"model",rawName:"v-model",value:r.settings.cost,expression:"settings.cost"}],staticClass:"price-input",attrs:{type:"number",min:"1",max:r.profile.account,placeholder:"抽卡消耗"},domProps:{value:r.settings.cost},on:{input:function(n){n.target.composing||r.$set(r.settings,"cost",n.target.value)}}}),t("p",[r._v("消耗：")])])])},h=[],g=(t("e25e"),{name:"TopBar",props:{title:{type:String,required:!0}},data:function(){return{settings:this.$settings,profile:this.$profile,mobile:!1}},computed:{canDraw:function(){return this.settings.cost>0&&this.$checkAccount(this.settings.cost)&&this.$canDraw()},topBarClass:function(){return(this.mobile?"mobile-":"")+"top-bar"}},methods:{drawCard:function(){var r=this.$draw();r&&alert(r)}},mounted:function(){var r=this.$refs.topBar.clientWidth,n=parseInt(getComputedStyle(this.$refs.topBar).fontSize);this.mobile=r<30*n}}),m=g,y=(t("8e06"),Object(d["a"])(m,v,h,!1,null,"b887b01c",null)),b=y.exports,w=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("div",{staticClass:"overlay"},[t("div",{staticClass:"cancel",on:{click:function(n){return r.$emit("exit-overlay")}}},[t("img",{attrs:{src:r.icons.cancel}})]),t("div",{staticClass:"content"},[r._t("default",[r._v("overlay")])],2)])},$=[],_=t("ad05"),x=t.n(_),k={name:"Overlay",data:function(){return{icons:{cancel:x.a}}}},j=k,C=(t("9f35"),Object(d["a"])(j,w,$,!1,null,"a15bc1a2",null)),O=C.exports,S=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("div",{staticClass:"settings"},[t("table",{staticClass:"settings-table"},[t("tr",[t("td",[r._v("夜间模式（未实现）")]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:r.darkMode,expression:"darkMode"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(r.darkMode)?r._i(r.darkMode,null)>-1:r.darkMode},on:{change:function(n){var t=r.darkMode,e=n.target,o=!!e.checked;if(Array.isArray(t)){var a=null,i=r._i(t,a);e.checked?i<0&&(r.darkMode=t.concat([a])):i>-1&&(r.darkMode=t.slice(0,i).concat(t.slice(i+1)))}else r.darkMode=o}}})])]),t("tr",[t("td",[r._v("自动抽卡（未实现）")]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:r.autoDraw,expression:"autoDraw"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(r.autoDraw)?r._i(r.autoDraw,null)>-1:r.autoDraw},on:{change:function(n){var t=r.autoDraw,e=n.target,o=!!e.checked;if(Array.isArray(t)){var a=null,i=r._i(t,a);e.checked?i<0&&(r.autoDraw=t.concat([a])):i>-1&&(r.autoDraw=t.slice(0,i).concat(t.slice(i+1)))}else r.autoDraw=o}}})])]),t("tr",[t("td",[r._v("消耗（注意界限）")]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:r.cost,expression:"cost"}],attrs:{type:"number",width:"4em"},domProps:{value:r.cost},on:{input:function(n){n.target.composing||(r.cost=n.target.value)}}})])])]),t("button",{on:{click:r.putNewPatterns}},[r._v("手动手动 添加/覆盖 模板")]),t("button",{on:{click:r.overwritePatterns}},[r._v("手动手动 重写 模板")]),t("button",{on:{click:r.clearSavedData}},[r._v("清除存档（慎重！）")])])},D=[],M=(t("4160"),t("07ac"),t("159b"),t("a630"),t("d81d"),t("a434"),t("b64b"),t("3ca3"),t("d4ec")),P=t("bee2"),A=function(){function r(){Object(M["a"])(this,r),this.map={},this.totalWeight=0}return Object(P["a"])(r,[{key:"put",value:function(r,n){this.map[r]=n,this.totalWeight+=n}},{key:"remove",value:function(r){var n=this.map[r];return delete this.map[r],this.totalWeight-=n,n}},{key:"roll",value:function(){for(var r=Math.random()*this.totalWeight,n=0,t=0,e=Object.keys(this.map);t<e.length;t++){var o=e[t],a=this.map[o];if(n+=a,n>r)return o}return null}},{key:"clear",value:function(){this.map={},this.totalWeight=0}}]),r}();function N(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.floor(Math.random()*(r-n)+n)}function B(r){return r[N(r.length)]}var E={profile:{storage:[],account:0,luck:.5,lastDraw:0,lastLogin:0},settings:{darkMode:!1,autoDraw:!1,cost:100},other:{uidGenerator:1},version:2},I=E;function T(){return I.other.uidGenerator++}function W(r){return Math.floor(r/864e5)}function L(){return W(Date.now())}function z(r){return W(r)<L()}var J="# vehicle\r\n车\r\n公交车\r\n飞机\r\n游轮\r\n船\r\n\r\n# estate\r\n汽车旅馆\r\n水族馆\r\n动物园\r\n中央公园\r\n体育馆\r\n大学\r\n博物馆\r\n图书馆\r\n植物园\r\n金字塔\r\n祭坛\r\n上古石堆\r\n考古现场\r\n田\r\n小溪\r\n大河\r\n沼泽\r\n疯人院\r\n\r\n# furniture\r\n椅子\r\n桌子\r\n床\r\n衣柜\r\n橱柜\r\n门\r\n镜子\r\n洗手台\r\n电视机\r\n茶几\r\n摇椅\r\n衣橱\r\n沙发\r\n空调\r\n鞋柜\r\n保险箱\r\n\r\n# direction\r\n旁边\r\n外面\r\n内部\r\n前面\r\n下方\r\n左边\r\n右边\r\n后头\r\n之上\r\n\r\n# name\r\n克苏鲁\r\n奈亚子\r\n古老者\r\n格拉道斯\r\n福尔摩斯\r\n黑法老\r\n修格斯\r\n奇美拉\r\n优格索托斯\r\n黑山羊\r\n达贡\r\n\r\n# np\r\n派大星\r\n苍老师\r\n雪龙\r\n喵单\r\n男妈妈\r\n星语\r\n浅鸽\r\n\r\n\r\n# vc\r\n江子未\r\n双儿\r\n元气\r\n斯布特\r\n暴龙\r\n修师傅\r\n玄妹妹\r\n\r\n\r\n# arkham\r\n格拉姆\r\n奇迹\r\n萧然\r\n凉皮\r\n里德护士\r\n\r\n\r\n# toho\r\n大新文\r\n博丽灵梦\r\n辉夜姬\r\n芙兰朵路\r\n咲夜\r\n\r\n# role\r\n[np]\r\n\r\n# anyone\r\n[name]\r\n[role]\r\n[role]的朋友\r\n\r\n# location\r\n拉莱耶\r\n北落师门星\r\n阿卡姆\r\n英斯茅斯\r\n未孕寨\r\n埃及\r\n玛雅遗址\r\n亚述古迹\r\n华盛顿\r\n波士顿\r\n\r\n# site\r\n[location]的[estate]\r\n[location]\r\n[role]的家\r\n[role]的密室\r\n[location]的[estate]的密室\r\n\r\n# place\r\n[furniture]\r\n[vehicle]\r\n[estate]\r\n[role]的[vehicle]\r\n[role]家的[furniture]\r\n[role]家[direction]\r\n\r\n# adj\r\n漂亮的\r\n邪恶的\r\n美丽的\r\n不可名状的\r\n外形特异的\r\n混沌的\r\n令人作呕的\r\n黏糊糊的\r\n有放射性的\r\n绿色\r\n红色\r\n白色\r\n闪耀着光点的\r\n深邃黑暗的\r\n古老\r\n肮脏\r\n污秽\r\n风之\r\n火之\r\n带电\r\n\r\n# item\r\n锤子\r\n雕塑\r\n泥像\r\n人偶\r\n神像\r\n画布\r\n油画\r\n相片\r\n笔记本\r\n锤子\r\n陶瓷盘子\r\n金属圆环\r\n丝线\r\n玻璃制品\r\n书\r\n剪刀\r\n橡树子\r\n布匹\r\n木雕\r\n玉器\r\n罗盘\r\n地图\r\n匕首\r\n羊皮纸\r\n\r\n# object\r\n[name]之[item]\r\n[name]的[item]\r\n[role]的[item]\r\n[role]朋友的[item]\r\n[adj][item]\r\n[adj][item]\r\n\r\n# reason\r\n大爆炸\r\n离奇死亡\r\n凭空而生的浓雾\r\n械斗\r\n意外\r\n过激言论\r\n不速之客的来访\r\n坠亡事件\r\n怪人的出现\r\n恐怖事件\r\n夏日里的飞雪\r\n海啸\r\n泥石流\r\n\r\n# full_reason\r\n考古学家们在[site]的[place]发现了[object]\r\n[role]染上了恶疾，终将不久于人世\r\n[location]的惊天奇案\r\n[location]的[object]被盗\r\n[role]曾收藏过的一个[object]离奇失踪\r\n[role]离奇死亡\r\n[role]死后留下了一笔不菲的遗产\r\n[role]在临终前留下了有关[object]的嘱托\r\n[role]葬礼上的[event]\r\n一次[event]\r\n在[site]发生的[event]\r\n缺钱\r\n受[role]所托\r\n不堪忍受[role]的压迫\r\n在[name]的神殿遇见了[anyone]\r\n\r\n# start\r\n[reason]\r\n[full_reason]\r\n\r\n# progress\r\n在[place]找到了[object]\r\n穿越了[site]，来到[site]\r\n离开了[site]\r\n与[role]展开了殊死搏斗\r\n加入了[role]一行人\r\n救下了[role]\r\n来到了[site]\r\n经历了各种困难险阻\r\n毁灭了[object]\r\n被[object]蛊惑\r\n走了些弯路\r\n掉落山崖\r\n掌控了[object]中的魔力\r\n释放了被囚禁于[object]中的[anyone]的灵魂\r\n实现了[anyone]的愿望\r\n完成了[location]领主的委托\r\n\r\n# end\r\n彻底疯了\r\n死于非命\r\n死于[anyone]之手\r\n被[object]救了一命\r\n被[anyone]救了一命\r\n被[role]用[object]救了一命\r\n放弃了思考\r\n发现了与[anyone]有关的真相\r\n发现了与[location]有关的事实\r\n选择了加入[role]\r\n了却了自己的一生\r\n打败了[anyone]\r\n在[place]战胜了[adj][anyone]而获得了自由\r\n与[role]喜结连理，并幸福地生活着\r\n用[object]结束了自己地一生\r\n\r\n# story\r\n由于[full_reason]，$role$不得不开始探索。在[progress]之后，$role$[end]。\r\n[reason]之后，$role$开始了旅程。先是[progress]，而后又[progress]，最后$role$[end]。\r\n因为[start]，$role$[progress]，然后，$role$[end]。\r\n[role]告诉$role$，他见证了[start]，$role$[progress]，然后，$role$[end]。\r\n[start]，迫使$role$[progress]，以至于$role$[end]。\r\n$role$曾经因[start]，而[progress]，现在却又不得不[progress]，又因为$role$[progress]，终于[end]。\r\n$role$曾向人讲述[name][progress]的故事，现在这事降临到自己身上，这次$role$[progress]，最后[end]。\r\n人们发现$role$[end]，经过调查发现原来$role$曾经[progress]，而一切的起因是[start]。\r\n$role$曾[progress]，最后[end]，经过调查，起因是[start]。\r\n迫于[start]，$role$最后[end]，而为此$role$甚至[progress]。",Z=[];function G(r){Z.push(r)}t("a4d3"),t("e01a"),t("d28b"),t("99af"),t("d3b7"),t("ac1f"),t("1276"),t("ddb0");var q=function(){function r(){Object(M["a"])(this,r),this.namespace={}}return Object(P["a"])(r,[{key:"compile",value:function(n){var t=null,e=n.split(F),o=!0,a=!1,i=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var l=c.value,u=K.exec(l);if(u)t=u[1],this.namespace[t]=[];else{if(Q.test(l))continue;var d=r.compilePattern(l),f=this.namespace[t];f&&f.push(d)}}}catch(p){a=!0,i=p}finally{try{o||null==s.return||s.return()}finally{if(a)throw i}}}},{key:"clear",value:function(){this.namespace={}}},{key:"put",value:function(r){var n,t=this.namespace[r];t||(t=[],this.namespace[r]=t);for(var e=arguments.length,o=new Array(e>1?e-1:0),a=1;a<e;a++)o[a-1]=arguments[a];(n=t).push.apply(n,o)}},{key:"get",value:function(r){return this.namespace[r]}},{key:"generate",value:function(r,n){var t=this.namespace[r],e=B(t),o="",a=!0,i=!1,c=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var u=s.value;o=o.concat(u.call(this,this,n))}}catch(d){i=!0,c=d}finally{try{a||null==l.return||l.return()}finally{if(i)throw c}}return o}}],[{key:"compilePattern",value:function(r){var n=0,t=[],e=null,o=function(){if(n<e.index){var o=r.substring(n,e.index);t.push((function(){return o}))}n=e.index+e[0].length;var a=e[2],i=e[4];a?t.push((function(r){return r.generate(a)})):i&&t.push((function(r,n){return n[i]}))};while(null!==(e=H.exec(r)))o();if(n<r.length){var a=r.substring(n);t.push((function(){return a}))}return t}}]),r}(),F=/\\n|\r?\n/g,H=/(\[\s*([0-9a-zA-Z_]+)\s*])|(\$(\s*[0-9a-zA-Z_]+\s*)\$)/g,K=/^#\s*([0-9a-zA-Z_]+)\s*/g,Q=/^\s*(;.*)?$/,R=new q;function U(r){return I.profile.account>=r}function V(){var r=I.settings.cost;if(U(r)&&nr()){I.profile.account-=r;var n=Date.now();I.profile.lastDraw=n;var t=or(Math.min(r/(60*(2-I.profile.luck)),2)),e=t.roll(),o=s[e],a=R.generate("role"),i={uid:T(),affixId:o.id,name:a,story:R.generate("story",{role:a}),address:R.generate("site",{role:a}),artifact:R.generate("object",{role:a}),color:o.color,timestamp:n};return I.profile.storage.push(i),G("抽到新卡："+o.text+i.name),rr(),null}return"余额不足或今日次数用尽"}var X="draw-each-day";function Y(){var r=JSON.parse(localStorage.getItem(X));if(r){var n=I.version;Object.assign(I,r),I.version=n}G("载入完毕")}function rr(){var r=JSON.stringify(I);localStorage.setItem(X,r),G("存档完毕")}function nr(){return z(I.profile.lastDraw)}function tr(){var r=Math.random()+.5;I.profile.luck=r;var n=20+N(Math.floor(80*r));I.profile.account+=n,rr(),G("新的一天到了呢，幸运值更新了哟~"),G("入账："+n)}function er(){R.compile(J),Y(),z(I.profile.lastLogin)&&tr(),I.profile.lastLogin=Date.now()}function or(r){var n=new A;return Object.values(s).forEach((function(t){return n.put(t.id,t.weight/(I.profile.luck+r))})),n}er();var ar={name:"Settings",data:function(){return this.$settings},methods:{putNewPatterns:function(){var r=prompt("请输入新的模板：");r&&R.compile(r)},overwritePatterns:function(){var r=prompt("请输入新的模板：");r&&(R.clear(),R.compile(r))},clearSavedData:function(){confirm("确认删除所有存档？它们会消失很久……真的很久很久……")&&localStorage.removeItem(X)}}},ir=ar,cr=(t("607f"),Object(d["a"])(ir,S,D,!1,null,"384179ce",null)),sr=cr.exports,lr=t("1f0e"),ur=t.n(lr),dr={name:"app",components:{Settings:sr,Overlay:O,TopBar:b,Card:p},data:function(){return{profile:this.$profile,settings:this.$settings,messages:this.$messageList,configureSettings:!1,icons:{settings:ur.a}}}},fr=dr,pr=(t("034f"),t("b0a0"),Object(d["a"])(fr,o,a,!1,null,null,null)),vr=pr.exports,hr={install:function(r){r.prototype.$draw=V,r.prototype.$checkAccount=U,r.prototype.$canDraw=nr,r.prototype.$saveData=rr,r.prototype.$profile=I.profile,r.prototype.$settings=I.settings,r.prototype.$showMessage=G,r.prototype.$messageList=Z}};e["a"].use(hr),e["a"].config.productionTip=!1,new e["a"]({render:function(r){return r(vr)}}).$mount("#app")},"5fd9":function(r,n,t){},"607f":function(r,n,t){"use strict";var e=t("5fd9"),o=t.n(e);o.a},"71f8":function(r,n,t){},"85ec":function(r,n,t){},"8e06":function(r,n,t){"use strict";var e=t("c47f"),o=t.n(e);o.a},"9f35":function(r,n,t){"use strict";var e=t("28fe"),o=t.n(e);o.a},ad05:function(r,n,t){r.exports=t.p+"img/cancel.74a88c29.svg"},b0a0:function(r,n,t){"use strict";var e=t("452c"),o=t.n(e);o.a},c47f:function(r,n,t){}});
//# sourceMappingURL=app.8e4a0837.js.map