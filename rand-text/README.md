# Rand Text

Use pattern below to generate a random phrase or sentence.

```
# pattern_set_key_1
token_1[pattern_set_key]...
token_n...
```

The`#`leads a new pattern set, then follows the patterns.

The pattern is a series of tokens. Tokens can be raw string, key token or name token.

- `raw` looks like string `This is a `, just string
- `key` looks like `[pattern_set_key]`. It will be replaced with a new string generated by the patter set key.
- `name` looks like `$name$`. It will be replaced with the `args` given while calling the method `PatternManager.generate(key, args)`

# API

## PatternManager

This is the main part of this module.

## PatternManager.compile(data)

Use this method to compile the pattern. This can call as many times as you like. This will append new patterns to the the existing pattern set. If the pattern set does not exists, it will create new pattern set, then append to it.

- data: the whole pattern, like an example below.

## PatternManager.prepare()

Use this method to prepare the generator. Mainly calculate the weight of each token, pattern and pattern set. And make a dice for sech pattern set.

This will visit all tokens and calculate the weight, so it might be a little time-casting. So I divide it from the compile method. If the manager does not change(did not call the compile method), this has no need to call.

Just remember **CALL THIS** before calling `PatternManager.generate(key, args)`!

## PatternManager.generate(key, args)

Use this method to generate a phrase or sentence(generally speaking the string).

- key: the pattern set key
- args: an object whitch determinate the replacement of `name` tokens

## PatternManager.clear()

Use this method to clear the manager. This will clear all data.

# Example

## Pattern

```
# country
British
Canada
Japan
France

# body
cellphone
harmmer
amulet
flower

# color
red
colorful
violet


# material
stone
jade
iron
steel

# prefix
extraordinary
godlike
mystery
horrible

# names
Cthulhu
Nyarlathotep
Yog-sothoth

# item
[prefix] [body] made of [material] from [country]
$enemy$'s [material] [body]
[color] [body]
the [material] that $role$ used to defeat $enemy$ in [country]
```



## Code

```javascript
let data = '...'; // Replace with the pattern above
let pm = new PatternManager();
pm.compile(data);
pm.prepare();

let env = {
  role: 'Doctor',
  enemy: 'Dalek',
}
let sentence = pm.generate('item', env); // Get the item name
```

## Output

These are results. Each calling of `pm.generate('item', env)` only returns ONE result!

```
mystery cellphone made of steel from France
the steel that Doctor used to defeat Dalek in Japan
extraordinary cellphone made of steel from Canada
horrible flower made of stone from Japan
mystery flower made of iron from Canada
extraordinary cellphone made of jade from Canada
horrible harmmer made of steel from France
horrible flower made of jade from British
```

