(this["webpackJsonpmind-node-2"]=this["webpackJsonpmind-node-2"]||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var o=n(6),i=n.n(o),s=n(13),a=n.n(s),r=(n(18),n(7)),c=n(10),u=n(5),d=n(1),l=n(2),h=n(4),f=n(3);n(19),n(20);function v(e){var t=[];for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=e[n];"string"===typeof o?t.push(o):o&&t.push(n)}return t.join(" ")}function p(e){var t,n=null===(t=e.current)||void 0===t?void 0:t.getBoundingClientRect();return{x:(null===n||void 0===n?void 0:n.x)||0,y:(null===n||void 0===n?void 0:n.y)||0,width:(null===n||void 0===n?void 0:n.width)||0,height:(null===n||void 0===n?void 0:n.height)||0}}n(21);var j=n(0),b=function(e){return e.stopPropagation()};var g=function(e){return Object(j.jsx)("div",{className:v({RadioButton:!0,border:!!e.border,checked:e.value}),onMouseDown:b,onMouseUp:b,onClick:function(){return e.onChange(!e.value)},children:e.children})};var O=function(e){var t=e.size||"auto",n="number"===typeof t?t+"px":t;return Object(j.jsx)("img",{alt:e.name,src:"icons/"+e.name+".svg",style:{width:n,height:n}})},y=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).selfRef=i.a.createRef(),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.onRectUpdate(this.props.node.uid,p(this.selfRef))}},{key:"componentDidUpdate",value:function(){this.props.onRectUpdate(this.props.node.uid,p(this.selfRef))}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,o=n.uid,i=Object(u.a)(n.position,2),s=i[0],a=i[1],r=n.text,c=n.background,d=n.color,l=Object(u.a)(t.anchor,2),h=l[0],f=l[1],p=t.linking,b=t.choosen,y=s+h,N=a+f;return Object(j.jsxs)("div",{className:v({MindNodeCard:!0,linking:p,choosen:b}),ref:this.selfRef,style:{left:"".concat(y,"px"),top:"".concat(N,"px")},onClick:function(t){return e.props.onClick(t,o)},onMouseDown:function(t){return e.props.onMouseDown(t,o)},onMouseMove:function(t){return e.props.onMouseMove(t,o)},onMouseUp:function(t){return e.props.onMouseUp(t,o)},children:[Object(j.jsx)("div",{className:"frame"}),Object(j.jsx)("div",{className:"static",style:{background:c},children:Object(j.jsxs)("div",{className:"wrapper",children:[Object(j.jsx)("div",{className:"text",style:{color:d},children:r.split("\n").map((function(e,t){return Object(j.jsx)("p",{children:e},t)}))}),Object(j.jsxs)("div",{className:"tool-bar",children:[Object(j.jsx)(g,{value:p,onChange:function(){return e.props.onClickLinkButton(o)},children:Object(j.jsx)(O,{name:"link",size:"80%"})},p?11:10),Object(j.jsx)(g,{value:b,onChange:function(t){return e.props.onClickChooseButton(o,t)},children:Object(j.jsx)(O,{name:"checked",size:"80%"})},b?1:0)]})]})})]})}}]),n}(o.Component),N=y,k=n(8),m=(n(23),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var o;return Object(d.a)(this,n),(o=t.call(this,e)).getBrief=function(e){var t=o.props.nodes.get(e);return t?"#"+e+"\uff1a"+t.text:"#"+e},o.state={inputingBackground:e.node.background,inputingColor:e.node.color,inputingText:e.node.text},o}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props.node,n=t.uid,o=t.position,i=t.outPorts,s=t.inPorts;return Object(j.jsxs)("div",{className:"MindNodeInfo",children:[Object(j.jsx)("div",{className:"top-bar"}),Object(j.jsxs)("div",{className:"content",children:[Object(j.jsxs)("p",{children:[Object(j.jsx)("span",{className:"title",children:"UID\uff1a"}),Object(j.jsxs)("span",{className:"text",children:["#",n]})]}),Object(j.jsxs)("p",{children:[Object(j.jsx)("span",{className:"title",children:"\u4f4d\u7f6e\uff1a"}),Object(j.jsxs)("span",{className:"text",children:["(",o.map((function(e){return e.toFixed(1)})).join(", "),")"]})]}),Object(j.jsxs)("p",{className:"field-color",children:[Object(j.jsx)("span",{className:"title",children:"\u80cc\u666f\u6837\u5f0f\uff1a"}),Object(j.jsx)("input",{className:"color-input",value:this.state.inputingBackground,onChange:function(t){return e.setBackground(t.target.value)}}),Object(j.jsx)("div",{className:"color-input-preview",style:{background:this.state.inputingBackground}})]}),Object(j.jsxs)("p",{className:"field-color",children:[Object(j.jsx)("span",{className:"title",children:"\u6587\u5b57\u6837\u5f0f\uff1a"}),Object(j.jsx)("input",{className:"color-input",value:this.state.inputingColor,onChange:function(t){return e.setColor(t.target.value)}}),Object(j.jsx)("div",{className:"color-input-preview",style:{background:this.state.inputingColor}})]}),Object(j.jsxs)("p",{children:[Object(j.jsx)("span",{className:"title",children:"\u5185\u5bb9\uff1a"}),Object(j.jsx)("textarea",{className:"text-input",value:this.state.inputingText,onChange:function(t){return e.setText(t.target.value)}})]}),Object(j.jsxs)("p",{className:"title",children:["\u51fa\u7ebf\uff08",i.length,"\u4e2a\uff09\uff1a"]}),Object(j.jsx)("ol",{className:"text",children:i.map((function(t){return Object(j.jsx)("li",{className:"snapshot",children:e.getBrief(t)},t)}))}),Object(j.jsxs)("p",{className:"title",children:["\u5165\u7ebf\uff08",s.length,"\u4e2a\uff09\uff1a"]}),Object(j.jsx)("ol",{className:"text",children:s.map((function(t){return Object(j.jsx)("li",{className:"snapshot",children:e.getBrief(t)},t)}))})]})]})}},{key:"setText",value:function(e){this.setState((function(){return{inputingText:e}}));var t=Object(k.a)(Object(k.a)({},this.props.node),{},{text:e});this.props.onUpdate(t)}},{key:"setBackground",value:function(e){this.setState((function(){return{inputingBackground:e}}));var t=Object(k.a)(Object(k.a)({},this.props.node),{},{background:e});this.props.onUpdate(t)}},{key:"setColor",value:function(e){this.setState((function(){return{inputingColor:e}}));var t=Object(k.a)(Object(k.a)({},this.props.node),{},{color:e});this.props.onUpdate(t)}}]),n}(o.Component));function x(e){var t=e.uid;return{uid:t,position:e.position,text:"#".concat(t),background:"#223344",color:"#ffffff",outPorts:[],inPorts:[]}}var M=function e(t){Object(d.a)(this,e),this.env=void 0,this.env=t},w=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"onStart",value:function(){}},{key:"onMove",value:function(){}},{key:"onEnd",value:function(e){var t=e.mousePosition,n=this.env.pixel2pool(t),o=this.env.genUid(),i=x({uid:o,position:n});this.env.nodes.set(o,i)}}]),n}(M);var P=function(){return[0,0]},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Number.isNaN(e)?[0,0]:[Math.cos(e)*t,Math.sin(e)*t]},U=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[t.reduce((function(e,t){return e+t[0]}),0),t.reduce((function(e,t){return e+t[1]}),0)]},S=function(e,t){return[e[0]-t[0],e[1]-t[1]]},R=function(e){if(0===e[0]&&0===e[1])return[0,0];var t=Math.atan2(e[1],e[0]);return[Math.cos(t),Math.sin(t)]},A=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])};function B(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(n.length<=1)return[n[0],0];for(var i=n;i.length>2;){for(var s=[],a=1;a<i.length;a++){var r=Object(u.a)(i[a-1],2),c=r[0],d=r[1],l=Object(u.a)(i[a],2),h=l[0],f=l[1];s.push([c+(h-c)*e,d+(f-d)*e])}i=s}var v=Object(u.a)(i[0],2),p=v[0],j=v[1],b=Object(u.a)(i[1],2),g=b[0],O=b[1],y=g-p,N=O-j,k=[p+y*e,j+N*e],m=Math.atan2(N,y);return[k,m]}var E=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).actived=!1,e.startMousePosition=P(),e.startNodePositions=new Map,e}return Object(l.a)(n,[{key:"onStart",value:function(e){var t=e.mousePosition,n=e.node;this.startNodePositions.clear(),this.startMousePosition=t,this.actived=!0;var o=Array.from(this.env.selectedNodeUids.values());n&&!this.env.selectedNodeUids.has(n.uid)&&(o=[n.uid],this.env.selectedNodeUids=new Set(o));var i,s=Object(c.a)(o);try{for(s.s();!(i=s.n()).done;){var a=i.value,r=this.env.nodes.get(a);r&&this.startNodePositions.set(a,r.position)}}catch(u){s.e(u)}finally{s.f()}}},{key:"onMove",value:function(e){var t=this,n=e.mousePosition;if(this.actived){var o=S(n,this.startMousePosition);this.startNodePositions.forEach((function(e,n){var i=t.env.nodes.get(n);i&&(i.position=U(e,o))}))}}},{key:"onEnd",value:function(){this.actived&&(this.startNodePositions.clear(),this.startMousePosition=P(),this.actived=!1)}}]),n}(M),T=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).actived=!1,e.startPoolOffset=P(),e.startMousePosition=P(),e}return Object(l.a)(n,[{key:"onStart",value:function(e){var t=e.mousePosition;this.startPoolOffset=this.env.offset,this.startMousePosition=t,this.actived=!0}},{key:"onMove",value:function(e){var t=e.mousePosition;this.actived&&(this.env.offset=U(this.startPoolOffset,S(t,this.startMousePosition)))}},{key:"onEnd",value:function(){this.actived&&(this.startPoolOffset=P(),this.startMousePosition=P(),this.actived=!1)}}]),n}(M),D=function(e,t){return e-t},F=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).actived=!1,e.startMousePosition=P(),e}return Object(l.a)(n,[{key:"onStart",value:function(e){var t=e.mousePosition;this.startMousePosition=t,this.actived=!0}},{key:"onMove",value:function(e){var t=e.mousePosition;if(this.actived){var n=S(t,this.startMousePosition),o=Object(u.a)(n,2),i=o[0],s=o[1];this.env.selectionArea={x:this.startMousePosition[0],y:this.startMousePosition[1],width:i,height:s}}}},{key:"onEnd",value:function(e){var t=this,n=e.mousePosition,o=e.node,i=e.nativeEvent;if(this.actived){var s=[];if(function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(this.startMousePosition,n))o&&(s=[o.uid]);else{var a=[this.startMousePosition[0],n[0]].sort(D),r=Object(u.a)(a,2),c=r[0],d=r[1],l=[this.startMousePosition[1],n[1]].sort(D),h=Object(u.a)(l,2),f=h[0],v=h[1];s=Array.from(this.env.nodes.values()).filter((function(e){return t.isNodeInRange(e,c,d,f,v)})).map((function(e){return e.uid}))}i.ctrlKey?s.forEach((function(e){return t.env.selectedNodeUids.add(e)})):this.env.selectedNodeUids=new Set(s),this.startMousePosition=P(),this.env.selectionArea=null,this.actived=!1}}},{key:"isNodeInRange",value:function(e,t,n,o,i){var s=this.env.getNodeRect(e.uid);if(!s)return!1;var a=s.x,r=s.y,c=s.width,u=s.height;return a>=t&&r>=o&&a+c<n&&r+u<i}}]),n}(M),L=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).tool=null,e}return Object(l.a)(n,[{key:"onStart",value:function(e){var t=e.node,n=e.nativeEvent;1===n.button?this.tool=new T(this.env):n.ctrlKey?this.tool=new F(this.env):n.shiftKey?this.tool=new w(this.env):this.tool=t?new E(this.env):new F(this.env),this.tool.onStart(e)}},{key:"onMove",value:function(e){var t;null===(t=this.tool)||void 0===t||t.onMove(e)}},{key:"onEnd",value:function(e){var t;null===(t=this.tool)||void 0===t||t.onEnd(e)}}]),n}(M),I=["createNode","dragNode","dragPool","select","auto"],z={createNode:"\u589e\u52a0",dragNode:"\u79fb\u52a8",dragPool:"\u62d6\u52a8",select:"\u9009\u62e9",auto:"\u81ea\u52a8"},V=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(e){var o;return Object(d.a)(this,n),(o=t.call(this,e)).mounted=!1,o.onkey=function(e){"Delete"===e.key&&o.deleteSelectedNodes()},o.poolRef=i.a.createRef(),o.canvasRef=i.a.createRef(),o.hideNodeInfoView=function(){return o.setState((function(){return{editingNodeUid:null}}))},o.nodeCardRects=new Map,o.selectedNodeUids=new Set,o.tool=null,o.origin=[0,0],o.resetView=function(){var e,t=null===(e=o.poolRef.current)||void 0===e?void 0:e.getBoundingClientRect();if(t){o.origin=[t.width/2,t.height/2];var n=o.canvasRef.current;n&&(n.width=t.width,n.height=t.height),o.notifyUpdate()}},o.dirty=!0,o.update=function(){o.mounted&&(o.dirty&&(o.updateStateNodes(),o.drawLines(),o.dirty=!1),requestAnimationFrame(o.update))},o.nodes=new Map,o.createNode=function(){var e=x({uid:o.genUid(),position:S([0,0],o.state.offset)});o.addNode(e)},o.linkingNodeUid=null,o.onClickNode=function(e,t){o.setState((function(){return{editingNodeUid:t}}))},o.onMouseDown=function(e,t){var n;null===(n=o.tool)||void 0===n||n.onStart(o.getToolEvent(e,t)),o.notifyUpdate()},o.onMouseMove=function(e,t){var n;null===(n=o.tool)||void 0===n||n.onMove(o.getToolEvent(e,t)),o.notifyUpdate()},o.onMouseUp=function(e,t){var n,i,s=o.getToolEvent(e,t);null===(n=o.tool)||void 0===n||n.onMove(s),null===(i=o.tool)||void 0===i||i.onEnd(s),o.notifyUpdate()},o.onMouseLeave=function(e,t){o.onMouseUp(e,t)},o.load=function(){try{var e=function(e){return{uidCounter:e.uidCounter||0,offset:e.offset||[0,0],scale:e.scale||1,nodes:e.nodes?e.nodes.map((function(e){return Object.assign(x(e),e)})):[]}}(JSON.parse(o.state.dataString));o.nodes.clear(),o.nodeCardRects.clear(),o.selectedNodeUids.clear(),e.nodes.forEach((function(e){return o.nodes.set(e.uid,e)})),o.setState((function(){return{uidCounter:e.uidCounter,offset:e.offset,nodes:e.nodes,scale:e.scale}}))}catch(t){alert("\u89e3\u6790\u6570\u636e\u5931\u8d25\uff01")}},o.save=function(){var e=o.buildPool();o.setState((function(){return{dataString:JSON.stringify(e)}})),console.log(e)},o.setNodeChoosen=function(e,t){t?o.selectedNodeUids.add(e):o.selectedNodeUids.delete(e),o.notifyUpdate()},o.unchooseAllNodes=function(){o.selectedNodeUids.clear(),o.notifyUpdate()},o.deleteSelectedNodes=function(){o.selectedNodeUids.forEach((function(e){o.nodes.delete(e),o.nodeCardRects.delete(e)})),o.selectedNodeUids.clear(),o.notifyUpdate()},o.state={uidCounter:0,nodes:[],offset:[0,0],scale:1,editingNodeUid:null,toolFlag:null,selectionArea:null,dataString:""},o}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.mounted=!0,this.updateStateNodes(),this.drawLines(),window.addEventListener("resize",this.resetView),window.addEventListener("keyup",this.onkey),this.resetView(),this.setTool("auto"),requestAnimationFrame(this.update)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resetView),window.removeEventListener("keyup",this.onkey),this.mounted=!1}},{key:"render",value:function(){var e=this;return Object(j.jsxs)("div",{className:"App",children:[this.renderTopBar(),Object(j.jsxs)("div",{className:"node-pool",ref:this.poolRef,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp,onMouseLeave:this.onMouseLeave,children:[Object(j.jsx)("canvas",{ref:this.canvasRef}),this.state.nodes.map((function(t){return Object(j.jsx)(N,{anchor:e.getAnchor(),node:t,linking:e.linkingNodeUid===t.uid,choosen:e.selectedNodeUids.has(t.uid),onClick:e.onClickNode,onMouseDown:e.onMouseDown,onMouseMove:e.onMouseMove,onMouseUp:e.onMouseUp,onRectUpdate:function(t,n){return e.setNodeRect(t,n)},onClickLinkButton:function(t){return e.linkNode(t)},onClickChooseButton:e.setNodeChoosen},t.uid)})),this.renderSelectionArea(),this.renderNodeInfo()]}),this.renderBottomBar()]})}},{key:"drawLines",value:function(){var e=this,t=function(e){var t=e.current;if(!t)return null;var n=t.getContext("2d");return n?[t,n]:null}(this.canvasRef);if(t){var n=Object(u.a)(t,2),o=n[0],i=n[1];i.clearRect(0,0,o.width,o.height),i.strokeStyle="#808080",i.fillStyle="#808080",i.lineWidth=1.5;for(var s=this.getPoolFix(),a=new Map,d=function(t){var n=a.get(t.uid);if(n)return n;var o=e.nodeCardRects.get(t.uid);if(o){var i=U(S([o.x,o.y],s),[o.width/2,o.height/2]);return a.set(t.uid,i),i}return[0,0]},l=this.nodes,h=new Map,f=function(e){if(h.has(e.uid))return h.get(e.uid)||NaN;var t,n=d(e),o=[0,0],i=Object(c.a)(e.inPorts);try{for(i.s();!(t=i.n()).done;){var s=t.value,a=l.get(s);a&&(o=U(o,R(S(n,d(a)))))}}catch(g){i.e(g)}finally{i.f()}o=R(o);var r,u=[0,0],f=Object(c.a)(e.outPorts);try{for(f.s();!(r=f.n()).done;){var v=r.value,p=l.get(v);p&&(u=U(u,R(S(d(p),n))))}}catch(g){f.e(g)}finally{f.f()}u=R(u);var j=U(o,u),b=Math.atan2(j[1],j[0]);return h.set(e.uid,b),b},v=0,p=Array.from(this.nodes.values());v<p.length;v++){var j,b=p[v],g=d(b),O=Object(c.a)(b.outPorts);try{for(O.s();!(j=O.n()).done;){var y=j.value,N=this.nodes.get(y);if(N){var k=d(N),m=A(S(k,g))/3,x=f(b),M=f(N),w=U(g,C(x,m)),P=S(k,C(M,m)),E=[g,w,P,k],T=B.apply(void 0,[.55].concat(E)),D=Object(u.a)(T,2),F=D[0],L=D[1];i.beginPath(),i.moveTo.apply(i,Object(r.a)(g)),i.bezierCurveTo.apply(i,Object(r.a)(w).concat(Object(r.a)(P),Object(r.a)(k))),i.stroke(),i.beginPath(),i.moveTo.apply(i,Object(r.a)(U(F,C(L,3*i.lineWidth)))),i.lineTo.apply(i,Object(r.a)(U(F,C(L+.8*Math.PI,3*i.lineWidth)))),i.lineTo.apply(i,Object(r.a)(U(F,C(L-.8*Math.PI,3*i.lineWidth)))),i.fill()}}}catch(I){O.e(I)}finally{O.f()}}}else console.log("Invalid canvas")}},{key:"renderTopBar",value:function(){var e=this;return Object(j.jsxs)("div",{className:"top-bar",children:[Object(j.jsx)("button",{onClick:this.createNode,children:"\u65b0\u589e"}),Object(j.jsx)("button",{onClick:this.save,children:"\u4fdd\u5b58"}),Object(j.jsx)("button",{onClick:this.load,children:"\u8f7d\u5165"}),Object(j.jsx)("button",{onClick:this.unchooseAllNodes,children:"\u53d6\u6d88\u9009\u62e9"}),Object(j.jsx)("button",{onClick:this.deleteSelectedNodes,children:"\u5220\u9664\u6240\u9009"}),I.map((function(t){return Object(j.jsx)("button",{onClick:e.setTool.bind(e,t),disabled:e.state.toolFlag===t,children:z[t]},t)})),Object(j.jsx)("textarea",{value:this.state.dataString,placeholder:"\u5728\u6b64\u8f93\u5165/\u8f93\u51fa\u6570\u636e",onChange:function(t){return e.setState((function(){return{dataString:t.target.value}}))}})]})}},{key:"renderBottomBar",value:function(){return Object(j.jsxs)("div",{className:"bottom-bar",children:[Object(j.jsxs)("span",{className:"piece",children:["\u603b\u8282\u70b9\u6570\uff1a",this.state.nodes.length]}),Object(j.jsxs)("span",{className:"piece",children:["\u9009\u4e2d\u8282\u70b9\u6570\uff1a",this.selectedNodeUids.size]})]})}},{key:"renderNodeInfo",value:function(){var e=this,t=null!==this.state.editingNodeUid?this.nodes.get(this.state.editingNodeUid):null;return t?Object(j.jsxs)("div",{className:"node-info",children:[Object(j.jsx)("button",{className:"icon",onClick:this.hideNodeInfoView,children:">"}),Object(j.jsx)(m,{node:t,nodes:this.nodes,onUpdate:function(t){return e.updateNode(t)}},t.uid)]}):null}},{key:"renderSelectionArea",value:function(){var e=this.state.selectionArea;if(!e)return null;var t=e.x,n=e.y,o=e.width,i=e.height,s=S([t,n],this.getPoolFix()),a=Object(u.a)(s,2),r=a[0],c=a[1];return o<0&&(r-=o=-o),i<0&&(c-=i=-i),Object(j.jsx)("div",{className:"section",style:{left:r+"px",top:c+"px",width:o+"px",height:i+"px"}})}},{key:"offset",get:function(){return this.state.offset},set:function(e){this.setState((function(){return{offset:e}}))}},{key:"scale",get:function(){return this.state.scale},set:function(e){this.setState((function(){return{scale:e}}))}},{key:"selectionArea",get:function(){return this.state.selectionArea},set:function(e){this.setState((function(){return{selectionArea:e}}))}},{key:"getNodeRect",value:function(e){return this.nodeCardRects.get(e)||null}},{key:"setNodeRect",value:function(e,t){this.nodeCardRects.set(e,t)}},{key:"setTool",value:function(e){switch(e){case"createNode":this.tool=new w(this);break;case"dragNode":this.tool=new E(this);break;case"dragPool":this.tool=new T(this);break;case"select":this.tool=new F(this);break;case"auto":this.tool=new L(this);break;default:this.tool=null}this.setState((function(){return{toolFlag:e}}))}},{key:"getAnchor",value:function(){return U(this.origin,this.state.offset)}},{key:"getPoolFix",value:function(){return[(null===(e=p(this.poolRef))||void 0===e?void 0:e.x)||0,(null===e||void 0===e?void 0:e.y)||0];var e}},{key:"notifyUpdate",value:function(){this.dirty=!0}},{key:"genUid",value:function(){var e=this.state.uidCounter;return this.setState((function(e){return{uidCounter:e.uidCounter+1}})),e}},{key:"addNode",value:function(e){this.nodes.set(e.uid,e),this.updateStateNodes()}},{key:"updateNode",value:function(e){this.nodes.set(e.uid,e),this.updateStateNodes()}},{key:"removeNode",value:function(e){this.nodes.delete(e),this.nodeCardRects.delete(e),this.selectedNodeUids.delete(e),this.updateStateNodes()}},{key:"updateStateNodes",value:function(){var e=this;this.setState((function(){return{nodes:Array.from(e.nodes.values())}}))}},{key:"linkNode",value:function(e){var t=this.nodes.get(e);if(t)if(null!==this.linkingNodeUid){if(this.linkingNodeUid!==t.uid){var n=this.nodes.get(this.linkingNodeUid);if(n&&t){var o=new Set(n.outPorts),i=new Set(t.inPorts);o.has(t.uid)?(o.delete(t.uid),i.delete(n.uid)):(o.add(t.uid),i.add(n.uid)),n.outPorts=Array.from(o),t.inPorts=Array.from(i),this.updateStateNodes()}}this.linkingNodeUid=null}else this.linkingNodeUid=t.uid}},{key:"getToolEvent",value:function(e,t){"number"===typeof t&&e.stopPropagation();var n="number"===typeof t&&this.nodes.get(t)||null;return{mousePosition:[e.clientX,e.clientY],node:n,nativeEvent:e}}},{key:"pool2pixel",value:function(e){return U(e,this.getAnchor())}},{key:"pixel2pool",value:function(e){return S(S(e,this.getAnchor()),this.getPoolFix())}},{key:"buildPool",value:function(){return{uidCounter:this.state.uidCounter,offset:this.state.offset,scale:this.state.scale,nodes:Array.from(this.nodes.values())}}}]),n}(o.Component),W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,25)).then((function(t){var n=t.getCLS,o=t.getFID,i=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),o(e),i(e),s(e),a(e)}))};a.a.render(Object(j.jsx)(i.a.StrictMode,{children:Object(j.jsx)(V,{})}),document.getElementById("root")),W()}},[[24,1,2]]]);
//# sourceMappingURL=main.f31424f0.chunk.js.map